exports.id=611,exports.ids=[611],exports.modules={1599:(e,t,i)=>{"use strict";i.d(t,{Z:()=>d});var a=i(997),s=i(9816),o=i.n(s),r=i(6689);let n={arkhangelsk:{name:'Серия "Архангельск"',icon:"\uD83C\uDFE0",models:[{id:"arch-6x2.5",width:6,height:2.5,title:"Новый Архангельск",area:15,price:45e4},{id:"arch-7x2.5",width:7,height:2.5,title:"Новый Архангельск",area:17.5,price:525e3},{id:"arch-8x2.5",width:8,height:2.5,title:"Новый Архангельск",area:20,price:6e5},{id:"arch-6x5",width:6,height:5,title:"Угловой Архангельск",area:30,price:9e5},{id:"arch-7x5",width:7,height:5,title:"Угловой Архангельск",area:35,price:105e4},{id:"arch-8x5",width:8,height:5,title:"Угловой Архангельск",area:40,price:12e5}]},barn:{name:'Серия "Барн"',icon:"\uD83C\uDFD8️",models:[{id:"barn-6x2.5",width:6,height:2.5,title:"Барнхаус",area:15,price:48e4},{id:"barn-7x2.5",width:7,height:2.5,title:"Барнхаус",area:17.5,price:56e4},{id:"barn-8x2.5",width:8,height:2.5,title:"Барнхаус",area:20,price:64e4},{id:"barn-6x5",width:6,height:5,title:"Барн с террасой",area:30,price:96e4},{id:"barn-7x5",width:7,height:5,title:"Барн с террасой",area:35,price:112e4},{id:"barn-8x5",width:8,height:5,title:"Барн с террасой",area:40,price:128e4}]},multi:{name:"Многомодульные решения",icon:"\uD83C\uDFE2",models:[{id:"dvin-6x5",width:6,height:5,title:"Двухмодульная Двинея",area:30,price:9e5},{id:"dvin-7x5",width:7,height:5,title:"Двухмодульная Двинея",area:35,price:105e4},{id:"dvin-8x5",width:8,height:5,title:"Двухмодульная Двинея",area:40,price:12e5},{id:"barn4-7x10",width:7,height:10,title:"Четырехмодульный Барн",area:70,price:21e5},{id:"barn4-8x10",width:8,height:10,title:"Четырехмодульный Барн",area:80,price:24e5}]}};function l({onComplete:e}){let[t,i]=(0,r.useState)(null),[s,l]=(0,r.useState)(!1),[x,c]=(0,r.useState)(6),[b,d]=(0,r.useState)(2.5),[f,h]=(0,r.useState)(20),[p,m]=(0,r.useState)(15),[u,y]=(0,r.useState)("arkhangelsk"),g=(t||s)&&f>0&&p>0,w=e=>{i(e),l(!1)};return(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 modal-overlay fade-in",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 modal-container slide-in",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 modal-header",children:[a.jsx("h2",{className:"jsx-28bcee4bb7cc19b0",children:"Настройка конструктора"}),a.jsx("p",{className:"jsx-28bcee4bb7cc19b0",children:"Выберите размер дома и участка для начала проектирования"})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 modal-content",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 section",children:[(0,a.jsxs)("h3",{className:"jsx-28bcee4bb7cc19b0",children:[a.jsx("span",{className:"jsx-28bcee4bb7cc19b0 section-icon",children:"\uD83D\uDCD0"}),"Размеры участка"]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 lot-inputs",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 input-group",children:[a.jsx("label",{className:"jsx-28bcee4bb7cc19b0",children:"Ширина участка (м)"}),a.jsx("input",{type:"number",value:f,onChange:e=>h(Number(e.target.value)),min:"10",max:"100",className:"jsx-28bcee4bb7cc19b0"})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 input-group",children:[a.jsx("label",{className:"jsx-28bcee4bb7cc19b0",children:"Длина участка (м)"}),a.jsx("input",{type:"number",value:p,onChange:e=>m(Number(e.target.value)),min:"10",max:"100",className:"jsx-28bcee4bb7cc19b0"})]})]})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 section",children:[(0,a.jsxs)("h3",{className:"jsx-28bcee4bb7cc19b0",children:[a.jsx("span",{className:"jsx-28bcee4bb7cc19b0 section-icon",children:"\uD83C\uDFE0"}),"Выбор дома"]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 house-selection-tabs",children:[a.jsx("button",{onClick:()=>l(!1),className:"jsx-28bcee4bb7cc19b0 "+((s?"":"active")||""),children:"Готовые проекты"}),a.jsx("button",{onClick:()=>{l(!0),i(null)},className:"jsx-28bcee4bb7cc19b0 "+((s?"active":"")||""),children:"Свои размеры"})]}),s?(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 custom-house",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 custom-visual",children:[a.jsx("div",{className:"jsx-28bcee4bb7cc19b0 custom-icon",children:"\uD83D\uDCCF"}),a.jsx("h4",{className:"jsx-28bcee4bb7cc19b0",children:"Индивидуальный размер"})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 custom-inputs",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 input-group",children:[a.jsx("label",{className:"jsx-28bcee4bb7cc19b0",children:"Ширина дома (м)"}),a.jsx("input",{type:"number",value:x,onChange:e=>c(Number(e.target.value)),min:"2",max:"20",step:"0.5",className:"jsx-28bcee4bb7cc19b0"})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 input-group",children:[a.jsx("label",{className:"jsx-28bcee4bb7cc19b0",children:"Длина дома (м)"}),a.jsx("input",{type:"number",value:b,onChange:e=>d(Number(e.target.value)),min:"2",max:"30",step:"0.5",className:"jsx-28bcee4bb7cc19b0"})]})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 custom-info",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 info-item",children:[a.jsx("span",{className:"jsx-28bcee4bb7cc19b0",children:"Площадь:"}),(0,a.jsxs)("strong",{className:"jsx-28bcee4bb7cc19b0",children:[(x*b).toFixed(1),"м\xb2"]})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 info-item",children:[a.jsx("span",{className:"jsx-28bcee4bb7cc19b0",children:"Примерная стоимость:"}),(0,a.jsxs)("strong",{className:"jsx-28bcee4bb7cc19b0",children:[(x*b*30).toFixed(0),"к ₽"]})]})]})]}):(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 preset-houses",children:[a.jsx("div",{className:"jsx-28bcee4bb7cc19b0 series-selector",children:Object.entries(n).map(([e,t])=>(0,a.jsxs)("button",{onClick:()=>y(e),className:"jsx-28bcee4bb7cc19b0 "+((u===e?"active":"")||""),children:[a.jsx("span",{className:"jsx-28bcee4bb7cc19b0 series-icon",children:t.icon}),t.name]},e))}),a.jsx("div",{className:"jsx-28bcee4bb7cc19b0 houses-grid",children:n[u].models.map(e=>(0,a.jsxs)("div",{onClick:()=>w(e),className:`jsx-28bcee4bb7cc19b0 house-card ${t?.id===e.id?"selected":""}`,children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 house-visual",children:[a.jsx("div",{className:"jsx-28bcee4bb7cc19b0 house-icon",children:"\uD83C\uDFE0"}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 house-dimensions",children:[e.width,"\xd7",e.height,"м"]})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 house-info",children:[a.jsx("h4",{className:"jsx-28bcee4bb7cc19b0",children:e.title}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 house-specs",children:[(0,a.jsxs)("span",{className:"jsx-28bcee4bb7cc19b0 area",children:[e.area,"м\xb2"]}),(0,a.jsxs)("span",{className:"jsx-28bcee4bb7cc19b0 price",children:[(e.price/1e3).toFixed(0),"к ₽"]})]})]})]},e.id))})]})]})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 modal-footer",children:[a.jsx("button",{onClick:()=>{e({house:s?{id:`custom-${Date.now()}`,width:x,height:b,area:x*b,price:x*b*3e4,title:`Модуль ${x}\xd7${b}м`}:t,lotSize:{width:f,height:p}})},disabled:!g,className:"jsx-28bcee4bb7cc19b0 proceed-btn",children:"Перейти к конструктору"}),!g&&a.jsx("p",{className:"jsx-28bcee4bb7cc19b0 warning",children:"Выберите размер дома и укажите размеры участка"})]})]}),a.jsx(o(),{id:"28bcee4bb7cc19b0",children:'.modal-overlay.jsx-28bcee4bb7cc19b0{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,.7);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;z-index:1000;padding:20px;-webkit-animation:fadeIn.3s ease-in-out;-moz-animation:fadeIn.3s ease-in-out;-o-animation:fadeIn.3s ease-in-out;animation:fadeIn.3s ease-in-out}@-webkit-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-o-keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@-webkit-keyframes slideIn{from{-webkit-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-webkit-transform:translatey(0);transform:translatey(0);opacity:1}}@-moz-keyframes slideIn{from{-moz-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-moz-transform:translatey(0);transform:translatey(0);opacity:1}}@-o-keyframes slideIn{from{-o-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-o-transform:translatey(0);transform:translatey(0);opacity:1}}@keyframes slideIn{from{-webkit-transform:translatey(-20px);-moz-transform:translatey(-20px);-o-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0);opacity:1}}.modal-container.jsx-28bcee4bb7cc19b0{background:var(--white);-webkit-border-radius:16px;-moz-border-radius:16px;border-radius:16px;max-width:1e3px;width:100%;max-height:95vh;overflow-y:auto;-webkit-box-shadow:0 25px 50px rgba(0,0,0,.25);-moz-box-shadow:0 25px 50px rgba(0,0,0,.25);box-shadow:0 25px 50px rgba(0,0,0,.25);-webkit-animation:slideIn.4s ease-out;-moz-animation:slideIn.4s ease-out;-o-animation:slideIn.4s ease-out;animation:slideIn.4s ease-out}.modal-header.jsx-28bcee4bb7cc19b0{background:-webkit-linear-gradient(315deg,var(--color-primary)0%,rgba(49,50,61,.95)100%);background:-moz-linear-gradient(315deg,var(--color-primary)0%,rgba(49,50,61,.95)100%);background:-o-linear-gradient(315deg,var(--color-primary)0%,rgba(49,50,61,.95)100%);background:linear-gradient(135deg,var(--color-primary)0%,rgba(49,50,61,.95)100%);color:var(--white);padding:32px 24px;-webkit-border-radius:16px 16px 0 0;-moz-border-radius:16px 16px 0 0;border-radius:16px 16px 0 0;text-align:center;position:relative;overflow:hidden}.modal-header.jsx-28bcee4bb7cc19b0::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:-webkit-linear-gradient(45deg,rgba(223,104,43,.1)0%,transparent 50%);background:-moz-linear-gradient(45deg,rgba(223,104,43,.1)0%,transparent 50%);background:-o-linear-gradient(45deg,rgba(223,104,43,.1)0%,transparent 50%);background:linear-gradient(45deg,rgba(223,104,43,.1)0%,transparent 50%);z-index:1}.modal-header.jsx-28bcee4bb7cc19b0 h2.jsx-28bcee4bb7cc19b0{font-size:28px;margin-bottom:8px;font-weight:700;position:relative;z-index:2}.modal-header.jsx-28bcee4bb7cc19b0 p.jsx-28bcee4bb7cc19b0{opacity:.9;font-size:16px;margin:0;position:relative;z-index:2}.modal-content.jsx-28bcee4bb7cc19b0{padding:32px 24px}.section.jsx-28bcee4bb7cc19b0{margin-bottom:32px}.section.jsx-28bcee4bb7cc19b0 h3.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:12px;font-size:20px;margin-bottom:20px;color:var(--color-primary);font-weight:600}.section-icon.jsx-28bcee4bb7cc19b0{font-size:16px}.lot-inputs.jsx-28bcee4bb7cc19b0{display:grid;grid-template-columns:1fr 1fr;gap:12px}.input-group.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:4px}.input-group.jsx-28bcee4bb7cc19b0 label.jsx-28bcee4bb7cc19b0{font-weight:500;color:var(--text-dark);font-size:12px}.input-group.jsx-28bcee4bb7cc19b0 input.jsx-28bcee4bb7cc19b0{padding:8px 10px;border:1px solid var(--border-gray);-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;font-size:13px;-webkit-transition:border-color.2s;-moz-transition:border-color.2s;-o-transition:border-color.2s;transition:border-color.2s}.input-group.jsx-28bcee4bb7cc19b0 input.jsx-28bcee4bb7cc19b0:focus{outline:none;border-color:var(--accent-orange)}.house-selection-tabs.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;background:var(--light-purple);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;padding:3px;margin-bottom:12px}.house-selection-tabs.jsx-28bcee4bb7cc19b0 button.jsx-28bcee4bb7cc19b0{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;padding:8px 10px;border:none;background:transparent;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;cursor:pointer;font-weight:500;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;font-size:12px}.house-selection-tabs.jsx-28bcee4bb7cc19b0 button.active.jsx-28bcee4bb7cc19b0{background:var(--accent-orange);color:var(--white)}.series-selector.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:6px;margin-bottom:12px;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.series-selector.jsx-28bcee4bb7cc19b0 button.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:6px;padding:6px 12px;border:1px solid var(--border-gray);background:var(--white);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;font-size:11px}.series-selector.jsx-28bcee4bb7cc19b0 button.active.jsx-28bcee4bb7cc19b0{border-color:var(--accent-orange);background:var(--light-purple)}.series-icon.jsx-28bcee4bb7cc19b0{font-size:14px}.houses-grid.jsx-28bcee4bb7cc19b0{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}.house-card.jsx-28bcee4bb7cc19b0{border:2px solid#e5e7eb;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:16px;cursor:pointer;-webkit-transition:all.3s cubic-bezier(.4,0,.2,1);-moz-transition:all.3s cubic-bezier(.4,0,.2,1);-o-transition:all.3s cubic-bezier(.4,0,.2,1);transition:all.3s cubic-bezier(.4,0,.2,1);background:var(--color-white);position:relative;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%;min-height:140px}.house-card.jsx-28bcee4bb7cc19b0::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:-webkit-linear-gradient(315deg,rgba(223,104,43,.05)0%,transparent 50%);background:-moz-linear-gradient(315deg,rgba(223,104,43,.05)0%,transparent 50%);background:-o-linear-gradient(315deg,rgba(223,104,43,.05)0%,transparent 50%);background:linear-gradient(135deg,rgba(223,104,43,.05)0%,transparent 50%);opacity:0;-webkit-transition:opacity.3s;-moz-transition:opacity.3s;-o-transition:opacity.3s;transition:opacity.3s}.house-card.jsx-28bcee4bb7cc19b0:hover{border-color:var(--color-accent);-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-ms-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px);-webkit-box-shadow:0 8px 16px rgba(223,104,43,.15);-moz-box-shadow:0 8px 16px rgba(223,104,43,.15);box-shadow:0 8px 16px rgba(223,104,43,.15)}.house-card.jsx-28bcee4bb7cc19b0:hover::before{opacity:1}.house-card.selected.jsx-28bcee4bb7cc19b0{border-color:var(--color-accent);background:-webkit-linear-gradient(315deg,rgba(223,104,43,.08)0%,rgba(223,104,43,.03)100%);background:-moz-linear-gradient(315deg,rgba(223,104,43,.08)0%,rgba(223,104,43,.03)100%);background:-o-linear-gradient(315deg,rgba(223,104,43,.08)0%,rgba(223,104,43,.03)100%);background:linear-gradient(135deg,rgba(223,104,43,.08)0%,rgba(223,104,43,.03)100%);-webkit-box-shadow:0 6px 16px rgba(223,104,43,.2);-moz-box-shadow:0 6px 16px rgba(223,104,43,.2);box-shadow:0 6px 16px rgba(223,104,43,.2)}.house-card.selected.jsx-28bcee4bb7cc19b0::after{content:"✓";position:absolute;top:8px;right:8px;width:20px;height:20px;background:var(--color-accent);color:var(--color-white);-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;font-size:12px;font-weight:bold;z-index:3}.house-visual.jsx-28bcee4bb7cc19b0{text-align:center;margin-bottom:12px;position:relative;z-index:2;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.house-icon.jsx-28bcee4bb7cc19b0{font-size:28px;margin-bottom:6px;-webkit-filter:drop-shadow(0 2px 4px rgba(0,0,0,.1));filter:drop-shadow(0 2px 4px rgba(0,0,0,.1));display:block}.house-dimensions.jsx-28bcee4bb7cc19b0{font-weight:600;color:var(--color-accent);font-size:14px;background:rgba(223,104,43,.1);padding:3px 8px;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;display:inline-block;white-space:nowrap}.house-info.jsx-28bcee4bb7cc19b0{position:relative;z-index:2;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.house-info.jsx-28bcee4bb7cc19b0 h4.jsx-28bcee4bb7cc19b0{font-size:12px;margin-bottom:8px;color:var(--color-primary);font-weight:600;line-height:1.3;white-space:normal;overflow:visible;-o-text-overflow:unset;text-overflow:unset;min-height:32px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.house-specs.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;font-size:11px;font-weight:500;gap:6px;margin-top:auto}.house-specs.jsx-28bcee4bb7cc19b0 .area.jsx-28bcee4bb7cc19b0{color:var(--color-primary);background:rgba(49,50,61,.1);padding:2px 6px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;white-space:nowrap;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.house-specs.jsx-28bcee4bb7cc19b0 .price.jsx-28bcee4bb7cc19b0{color:var(--color-accent);background:rgba(223,104,43,.1);padding:2px 6px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;white-space:nowrap;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-weight:600}.custom-house.jsx-28bcee4bb7cc19b0{border:1px solid var(--border-gray);-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;padding:14px;background:var(--light-purple)}.custom-visual.jsx-28bcee4bb7cc19b0{text-align:center;margin-bottom:12px}.custom-icon.jsx-28bcee4bb7cc19b0{font-size:24px;margin-bottom:4px}.custom-inputs.jsx-28bcee4bb7cc19b0{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:12px}.custom-info.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:8px;background:var(--white);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px}.info-item.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:2px;text-align:center}.info-item.jsx-28bcee4bb7cc19b0 span.jsx-28bcee4bb7cc19b0{font-size:10px;color:var(--text-light)}.info-item.jsx-28bcee4bb7cc19b0 strong.jsx-28bcee4bb7cc19b0{font-size:12px;color:var(--accent-orange)}.modal-footer.jsx-28bcee4bb7cc19b0{padding:24px;border-top:1px solid#e5e7eb;text-align:center;background:#f9fafb}.proceed-btn.jsx-28bcee4bb7cc19b0{background:-webkit-linear-gradient(315deg,var(--color-accent)0%,#e8763a 100%);background:-moz-linear-gradient(315deg,var(--color-accent)0%,#e8763a 100%);background:-o-linear-gradient(315deg,var(--color-accent)0%,#e8763a 100%);background:linear-gradient(135deg,var(--color-accent)0%,#e8763a 100%);color:var(--white);border:none;padding:16px 32px;-webkit-border-radius:50px;-moz-border-radius:50px;border-radius:50px;font-size:16px;font-weight:600;cursor:pointer;-webkit-transition:all.3s cubic-bezier(.4,0,.2,1);-moz-transition:all.3s cubic-bezier(.4,0,.2,1);-o-transition:all.3s cubic-bezier(.4,0,.2,1);transition:all.3s cubic-bezier(.4,0,.2,1);margin-bottom:12px;-webkit-box-shadow:0 4px 12px rgba(223,104,43,.3);-moz-box-shadow:0 4px 12px rgba(223,104,43,.3);box-shadow:0 4px 12px rgba(223,104,43,.3);position:relative;overflow:hidden}.proceed-btn.jsx-28bcee4bb7cc19b0::before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:-webkit-linear-gradient(left,transparent,rgba(255,255,255,.2),transparent);background:-moz-linear-gradient(left,transparent,rgba(255,255,255,.2),transparent);background:-o-linear-gradient(left,transparent,rgba(255,255,255,.2),transparent);background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);-webkit-transition:left.6s ease;-moz-transition:left.6s ease;-o-transition:left.6s ease;transition:left.6s ease}.proceed-btn.jsx-28bcee4bb7cc19b0:hover:not(:disabled)::before{left:100%}.proceed-btn.jsx-28bcee4bb7cc19b0:hover:not(:disabled){-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-ms-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px);-webkit-box-shadow:0 8px 20px rgba(223,104,43,.4);-moz-box-shadow:0 8px 20px rgba(223,104,43,.4);box-shadow:0 8px 20px rgba(223,104,43,.4)}.proceed-btn.jsx-28bcee4bb7cc19b0:disabled{background:var(--border-gray);cursor:not-allowed}.warning.jsx-28bcee4bb7cc19b0{color:var(--accent-orange);font-size:11px;margin:0}@media(max-width:768px){.modal-container.jsx-28bcee4bb7cc19b0{margin:10px;max-height:95vh;max-width:-webkit-calc(100vw - 20px);max-width:-moz-calc(100vw - 20px);max-width:calc(100vw - 20px)}.modal-header.jsx-28bcee4bb7cc19b0{padding:24px 16px}.modal-header.jsx-28bcee4bb7cc19b0 h2.jsx-28bcee4bb7cc19b0{font-size:24px}.modal-content.jsx-28bcee4bb7cc19b0{padding:24px 16px}.lot-inputs.jsx-28bcee4bb7cc19b0,.custom-inputs.jsx-28bcee4bb7cc19b0{grid-template-columns:1fr}.houses-grid.jsx-28bcee4bb7cc19b0{grid-template-columns:repeat(2,1fr);gap:10px}.house-card.jsx-28bcee4bb7cc19b0{padding:12px;min-height:120px}.house-info.jsx-28bcee4bb7cc19b0 h4.jsx-28bcee4bb7cc19b0{min-height:40px}.series-selector.jsx-28bcee4bb7cc19b0{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.custom-info.jsx-28bcee4bb7cc19b0{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:12px}}'})]})}var x=i(5152);let c=i.n(x)()(()=>i.e(802).then(i.bind(i,7802)),{loadableGenerated:{modules:["components\\ConstructorApp\\constructor\\ConstructorInterface.js -> ./House3DViewer"]},ssr:!1,loading:()=>a.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#000",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"18px",zIndex:1e3},children:"Загрузка 3D модели..."})});function b({initialData:e,onBack:t}){let i=(0,r.useRef)(null),[s,n]=(0,r.useState)(1),[l,x]=(0,r.useState)({x:0,y:0}),[b,d]=(0,r.useState)(!1),[f,h]=(0,r.useState)({x:0,y:0}),[p,m]=(0,r.useState)("select"),[u,y]=(0,r.useState)(!1),[g,w]=(0,r.useState)(null),[j,k]=(0,r.useState)(null),[v,z]=(0,r.useState)(null),[M,N]=(0,r.useState)([]),[S,D]=(0,r.useState)([]),[I,T]=(0,r.useState)(new Set(["house"])),[C,W]=(0,r.useState)(!0),[F,A]=(0,r.useState)(null),[E,R]=(0,r.useState)(null),[P,X]=(0,r.useState)(!1),[Y,$]=(0,r.useState)(null),[H,B]=(0,r.useState)(null),[L,q]=(0,r.useState)(null),[O,_]=(0,r.useState)(!1),[J,U]=(0,r.useState)({}),[G,K]=(0,r.useState)([]),[Z,V]=(0,r.useState)(-1),[Q,ee]=(0,r.useState)([]),[et,ei]=(0,r.useState)([]),[ea,es]=(0,r.useState)([]),eo=()=>{let e=i.current;if(!e||0===e.width||0===e.height)return;let t=e.getContext("2d");if(t.clearRect(0,0,e.width,e.height),t.save(),t.translate(l.x,l.y),er(t),en(t),el(t),ec(t),eQ(t),e0(t),P&&Y&&H){t.strokeStyle="#ff9800",t.lineWidth=3,t.setLineDash([5,5]),t.beginPath(),t.moveTo(Y.x*s,Y.y*s),t.lineTo(H.x*s,H.y*s),t.stroke(),t.setLineDash([]);let e=Math.sqrt(Math.pow(H.x-Y.x,2)+Math.pow(H.y-Y.y,2)),i=(Y.x+H.x)/2*s,a=(Y.y+H.y)/2*s;t.fillStyle="#ff9800",t.font="12px Arial",t.textAlign="center",t.fillText(`${(e/30*1e3).toFixed(0)}мм`,i,a-10)}t.restore()},er=e=>{let t=i.current;if(!t)return;let a=20*s;for(;a<8;)a*=2;for(;a>80;)a/=2;if(a<5)return;let o=2*Math.max(t.width,t.height),r=-l.x-o,n=-l.y-o,x=-l.x+t.width+o,c=-l.y+t.height+o,b=Math.floor(r/a)*a,d=Math.floor(n/a)*a,f=Math.ceil(x/a)*a+a,h=Math.ceil(c/a)*a+a;e.strokeStyle="rgba(255, 255, 255, 0.08)",e.lineWidth=.5;for(let i=b;i<=f;i+=a){let a=i+l.x;e.beginPath(),e.moveTo(a,-o),e.lineTo(a,t.height+o),e.stroke()}for(let i=d;i<=h;i+=a){let a=i+l.y;e.beginPath(),e.moveTo(-o,a),e.lineTo(t.width+o,a),e.stroke()}if(a<=50){e.strokeStyle="rgba(255, 255, 255, 0.15)",e.lineWidth=1;let i=5*a,s=Math.floor(r/i)*i,b=Math.floor(n/i)*i,d=Math.ceil(x/i)*i+i,f=Math.ceil(c/i)*i+i;for(let a=s;a<=d;a+=i){let i=a+l.x;e.beginPath(),e.moveTo(i,-o),e.lineTo(i,t.height+o),e.stroke()}for(let a=b;a<=f;a+=i){let i=a+l.y;e.beginPath(),e.moveTo(-o,i),e.lineTo(t.width+o,i),e.stroke()}}},en=t=>{let i,a;let o=M.find(e=>"house"===e.type);if(!o)return;let r=30*e.lotSize.width*s,n=30*e.lotSize.height*s;C?(i=100*s,a=100*s):(i=o.x*s-50*s,a=o.y*s-50*s);let l=o.x*s,x=o.y*s,c=o.width*s,b=o.height*s,d=l<i||x<a||l+c>i+r||x+b>a+n;t.fillStyle=d?"rgba(255, 0, 0, 0.1)":"rgba(200, 200, 200, 0.05)",t.fillRect(i,a,r,n),t.strokeStyle=d?"#ff0000":C?"#2196f3":"#666",t.lineWidth=Math.max(2,3*s);let f=Math.max(8,15*s);if(t.setLineDash([f,.6*f]),t.strokeRect(i,a,r,n),t.setLineDash([]),"fix"===p&&F?.type==="lot"&&(t.strokeStyle="#ffff00",t.lineWidth=3,t.strokeRect(i,a,r,n)),C&&s>=.4){let e=i+r-30,s=a+10;t.fillStyle="#ff0000",t.fillRect(e,s,20,20),t.strokeStyle="#fff",t.lineWidth=1,t.strokeRect(e,s,20,20),t.fillStyle="#fff",t.font="12px Arial",t.textAlign="center",t.fillText("\uD83D\uDD12",e+10,s+14)}if(E?.type==="lot"&&s>=.4){let e=i+r-30,s=a+10;t.fillStyle="#00ff00",t.fillRect(e,s,20,20),t.strokeStyle="#fff",t.lineWidth=1,t.strokeRect(e,s,20,20),t.fillStyle="#fff",t.font="12px Arial",t.textAlign="center",t.fillText("\uD83D\uDD13",e+10,s+14)}if(s>=.3){t.fillStyle=d?"#ff0000":"#666",t.font="14px Arial",t.textAlign="center";let o=(e.lotSize.width*e.lotSize.height/100).toFixed(2);t.fillText(`${(1e3*e.lotSize.width).toFixed(0)}мм`,i+r/2,a-10*s),t.save(),t.translate(i-20*s,a+n/2),t.rotate(-Math.PI/2),t.fillText(`${(1e3*e.lotSize.height).toFixed(0)}мм`,0,0),t.restore(),t.fillText(`${o} соток`,i+r/2,a+n+20*s)}d&&s>=.4&&(t.fillStyle="#ff0000",t.font="12px Arial",t.textAlign="center",t.fillText("Дом выходит за границы участка!",i+r/2,a+n+25*s))},el=e=>{M.forEach(t=>{ex(e,t)})},ex=(e,t)=>{let i=g?.id===t.id,a=I.has(t.id),o="select"===p&&F?.id===t.id,r=t.width*s,n=t.height*s,l=t.x*s,x=t.y*s;if("house"===t.type?e.fillStyle=i?"#d4c5e8":o?"#f0e8ff":a?"#e8f4d4":"#eee8f4":e.fillStyle=i?"#c5d4e8":o?"#e8f0ff":a?"#d4e8c5":"#e8f4ee",e.fillRect(l,x,r,n),e.strokeStyle=i?"#df682b":o?"#9c27b0":a?"#4caf50":"#31323d",e.lineWidth=i?Math.max(2,3*s):o?Math.max(2,2*s):Math.max(1,2*s),e.strokeRect(l,x,r,n),"fix"===p&&F?.id===t.id&&(e.strokeStyle="#ffff00",e.lineWidth=3,e.strokeRect(l-2,x-2,r+4,n+4)),a&&s>=.4){let t=l+r-25,i=x+5;e.fillStyle="#ff0000",e.fillRect(t,i,20,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(t,i,20,20),e.fillStyle="#fff",e.font="12px Arial",e.textAlign="center",e.fillText("\uD83D\uDD12",t+10,i+14)}if(E?.id===t.id&&s>=.4){let t=l+r-25,i=x+5;e.fillStyle="#00ff00",e.fillRect(t,i,20,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(t,i,20,20),e.fillStyle="#fff",e.font="12px Arial",e.textAlign="center",e.fillText("\uD83D\uDD13",t+10,i+14)}if(s>=.3&&"house"!==t.type){e.fillStyle="#31323d",e.font="10px Arial",e.textAlign="center";let i=l+r/2,a=x+n/2;t.realWidth&&t.realHeight&&e.fillText(`${(1e3*t.realWidth).toFixed(0)}\xd7${(1e3*t.realHeight).toFixed(0)}мм`,i,a-5*s)}if(s>=.5){e.fillStyle="#df682b",e.font="8px Arial";let i=l+r/2,a=x+n/2;e.fillText(`${(1e3*(t.realWidth||0)).toFixed(0)}мм`,i,x-8*s),e.save(),e.translate(l-12*s,a),e.rotate(-Math.PI/2),e.fillText(`${(1e3*(t.realHeight||0)).toFixed(0)}мм`,0,0),e.restore()}i&&"select"===p&&!a&&eN(e,{...t,x:l,y:x,width:r,height:n})},ec=e=>{S.forEach(t=>{eM(e,t)}),ez(e)},eb=e=>{let t=G.slice(0,Z+1);t.push({elements:JSON.parse(JSON.stringify(e.elements||M)),walls:JSON.parse(JSON.stringify(e.walls||S)),doors:JSON.parse(JSON.stringify(e.doors||Q)),windows:JSON.parse(JSON.stringify(e.windows||et))}),t.length>50?t.shift():V(e=>e+1),K(t)},ed=()=>{let e=M.find(e=>"house"===e.type);if(!e||0===S.length)return[];let t=[...S],i=[{id:"house-top",x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y,type:"boundary"},{id:"house-right",x1:e.x+e.width,y1:e.y,x2:e.x+e.width,y2:e.y+e.height,type:"boundary"},{id:"house-bottom",x1:e.x+e.width,y1:e.y+e.height,x2:e.x,y2:e.y+e.height,type:"boundary"},{id:"house-left",x1:e.x,y1:e.y+e.height,x2:e.x,y2:e.y,type:"boundary"}];t.push(...i);let a=new Set([e.x,e.x+e.width]),s=new Set([e.y,e.y+e.height]);S.forEach(t=>{t.x1>=e.x&&t.x1<=e.x+e.width&&a.add(t.x1),t.x2>=e.x&&t.x2<=e.x+e.width&&a.add(t.x2),t.y1>=e.y&&t.y1<=e.y+e.height&&s.add(t.y1),t.y2>=e.y&&t.y2<=e.y+e.height&&s.add(t.y2)}),ef(t).forEach(t=>{t.x>=e.x&&t.x<=e.x+e.width&&a.add(t.x),t.y>=e.y&&t.y<=e.y+e.height&&s.add(t.y)});let o=Array.from(a).sort((e,t)=>e-t),r=Array.from(s).sort((e,t)=>e-t),n=[];for(let e=0;e<o.length-1;e++)for(let i=0;i<r.length-1;i++){let a=o[e],s=o[e+1],l=r[i],x=r[i+1];if(s-a>=15&&x-l>=15&&eh(a,l,s,x,t)){let e=eu(a,l,s,x,S);n.push({bounds:{minX:a,maxX:s,minY:l,maxY:x},walls:e,area:(s-a)*(x-l)/900,width:(s-a)/30,height:(x-l)/30})}}return n},ef=e=>{let t=[];for(let i=0;i<e.length;i++)for(let a=i+1;a<e.length;a++){let s=ep(e[i].x1,e[i].y1,e[i].x2,e[i].y2,e[a].x1,e[a].y1,e[a].x2,e[a].y2);s&&t.push(s)}return t},eh=(e,t,i,a,s)=>[{x1:e,y1:t,x2:i,y2:t,name:"top"},{x1:i,y1:t,x2:i,y2:a,name:"right"},{x1:e,y1:a,x2:i,y2:a,name:"bottom"},{x1:e,y1:t,x2:e,y2:a,name:"left"}].every(e=>s.some(t=>em(e.x1,e.y1,e.x2,e.y2,t.x1,t.y1,t.x2,t.y2,2))),ep=(e,t,i,a,s,o,r,n)=>{let l=(e-i)*(o-n)-(t-a)*(s-r);if(.001>Math.abs(l))return null;let x=((e-s)*(o-n)-(t-o)*(s-r))/l,c=-((e-i)*(t-o)-(t-a)*(e-s))/l;return x>=0&&x<=1&&c>=0&&c<=1?{x:e+x*(i-e),y:t+x*(a-t)}:null},em=(e,t,i,a,s,o,r,n,l)=>Math.abs(t-a)<l&&Math.abs(o-n)<l&&Math.abs(t-o)<l?Math.max(Math.min(e,i),Math.min(s,r))<=Math.min(Math.max(e,i),Math.max(s,r))+l:!!(Math.abs(e-i)<l&&Math.abs(s-r)<l&&Math.abs(e-s)<l)&&Math.max(Math.min(t,a),Math.min(o,n))<=Math.min(Math.max(t,a),Math.max(o,n))+l,eu=(e,t,i,a,s)=>s.filter(s=>2>Math.abs(s.y1-t)&&2>Math.abs(s.y2-t)&&s.x1>=e-2&&s.x2<=i+2||2>Math.abs(s.y1-a)&&2>Math.abs(s.y2-a)&&s.x1>=e-2&&s.x2<=i+2||2>Math.abs(s.x1-e)&&2>Math.abs(s.x2-e)&&s.y1>=t-2&&s.y2<=a+2||2>Math.abs(s.x1-i)&&2>Math.abs(s.x2-i)&&s.y1>=t-2&&s.y2<=a+2),ey=e=>{let t=M.find(e=>"house"===e.type);return t&&(S.forEach(t=>{[{new:"start",existing:"start",newCoord:[e.x1,e.y1],existingCoord:[t.x1,t.y1]},{new:"start",existing:"end",newCoord:[e.x1,e.y1],existingCoord:[t.x2,t.y2]},{new:"end",existing:"start",newCoord:[e.x2,e.y2],existingCoord:[t.x1,t.y1]},{new:"end",existing:"end",newCoord:[e.x2,e.y2],existingCoord:[t.x2,t.y2]}].forEach(t=>{15>Math.sqrt(Math.pow(t.newCoord[0]-t.existingCoord[0],2)+Math.pow(t.newCoord[1]-t.existingCoord[1],2))&&("start"===t.new?(e.x1=t.existingCoord[0],e.y1=t.existingCoord[1]):(e.x2=t.existingCoord[0],e.y2=t.existingCoord[1]))})}),[{x:t.x,y:t.y,width:t.width,height:0,type:"top"},{x:t.x+t.width,y:t.y,width:0,height:t.height,type:"right"},{x:t.x,y:t.y+t.height,width:t.width,height:0,type:"bottom"},{x:t.x,y:t.y,width:0,height:t.height,type:"left"}].forEach(t=>{"top"===t.type||"bottom"===t.type?(15>Math.abs(e.y1-t.y)&&(e.y1=t.y),15>Math.abs(e.y2-t.y)&&(e.y2=t.y)):(15>Math.abs(e.x1-t.x)&&(e.x1=t.x),15>Math.abs(e.x2-t.x)&&(e.x2=t.x))})),e},eg=e=>{if(!e.bounds)return 0;let t=(e.bounds.maxX-e.bounds.minX)/30;return(e.bounds.maxY-e.bounds.minY)/30*t},ew=e=>e.bounds?{x:(e.bounds.minX+e.bounds.maxX)/2,y:(e.bounds.minY+e.bounds.maxY)/2}:{x:0,y:0},ej=(e,t)=>{let i=ed();for(let a=0;a<i.length;a++)if(ek(e,t,i[a]))return a;return null},ek=(e,t,i)=>!!i.bounds&&e>=i.bounds.minX&&e<=i.bounds.maxX&&t>=i.bounds.minY&&t<=i.bounds.maxY,ev=e=>{let t=prompt("Введите название комнаты:",J[e]||`Комната ${e+1}`);null!==t&&U(i=>({...i,[e]:t}))},ez=e=>{ed().forEach((t,i)=>{let a=ew(t),o=eg(t);if(o>.3&&s>=.3){e.fillStyle="#2196f3",e.font="12px Arial",e.textAlign="center";let r=J[i]||`Комната ${i+1}`;e.fillText(r,a.x*s,a.y*s-8),e.font="10px Arial",e.fillText(`${o.toFixed(1)}м\xb2`,a.x*s,a.y*s+8);let n=(t.bounds.maxX-t.bounds.minX)/30,l=(t.bounds.maxY-t.bounds.minY)/30;e.fillStyle="#666",e.font="9px Arial",e.fillText(`${(1e3*n).toFixed(0)}\xd7${(1e3*l).toFixed(0)}мм`,a.x*s,a.y*s+20),t.walls&&t.walls.length>0&&(e.fillStyle="#ff6b35",e.font="8px Arial",e.fillText(`Стен: ${t.walls.length}`,a.x*s,a.y*s+32))}})},eM=(e,t)=>{let i=g?.id===t.id,a=ea.some(e=>e.id===t.id),o="select"===p&&L?.id===t.id,r=t.x1*s,n=t.y1*s,l=t.x2*s,x=t.y2*s,c=[...Q.filter(e=>e.wallId===t.id),...et.filter(e=>e.wallId===t.id)];if(e.strokeStyle=i?"#df682b":a?"#2196f3":o?"#ff9800":"#8B4513",e.lineWidth=Math.max(3,30*t.thickness*s),0===c.length)e.beginPath(),e.moveTo(r,n),e.lineTo(l,x),e.stroke();else{let i=Math.sqrt(Math.pow(t.x2-t.x1,2)+Math.pow(t.y2-t.y1,2)),a=c.sort((e,t)=>e.position-t.position),o=0;if(a.forEach(a=>{let r=Math.max(0,a.position-a.width/(2*i)),n=Math.min(1,a.position+a.width/(2*i));if(o<r){let i=t.x1+(t.x2-t.x1)*o,a=t.y1+(t.y2-t.y1)*o,n=t.x1+(t.x2-t.x1)*r,l=t.y1+(t.y2-t.y1)*r;e.beginPath(),e.moveTo(i*s,a*s),e.lineTo(n*s,l*s),e.stroke()}o=n}),o<1){let i=t.x1+(t.x2-t.x1)*o,a=t.y1+(t.y2-t.y1)*o;e.beginPath(),e.moveTo(i*s,a*s),e.lineTo(l,x),e.stroke()}}if((i||a)&&"select"===p){e.fillStyle="#df682b",e.strokeStyle="#fff",e.lineWidth=1;let o=Math.max(6,8*s);e.beginPath(),e.arc(r,n,o,0,2*Math.PI),e.fill(),e.stroke(),e.beginPath(),e.arc(l,x,o,0,2*Math.PI),e.fill(),e.stroke();let c=(r+l)/2,b=(n+x)/2;if(e.fillStyle="#2196f3",e.beginPath(),e.arc(c,b,o,0,2*Math.PI),e.fill(),e.stroke(),i&&!a){let i=Math.min(n,x)-40,a=S.some(e=>e.id!==t.id&&(5>Math.abs(e.x1-t.x1)&&5>Math.abs(e.y1-t.y1)||5>Math.abs(e.x2-t.x2)&&5>Math.abs(e.y2-t.y2)||5>Math.abs(e.x1-t.x2)&&5>Math.abs(e.y1-t.y2)||5>Math.abs(e.x2-t.x1)&&5>Math.abs(e.y2-t.y1))),s=a?3:2,o=c-(24*s+(s-1)*5)/2;e.fillStyle="#ff4444",e.fillRect(o,i,24,24),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(o,i,24,24),e.fillStyle="#fff",e.font="16px Arial",e.textAlign="center",e.fillText("\uD83D\uDDD1️",o+12,i+16),e.fillStyle="#4CAF50",e.fillRect(o+24+5,i,24,24),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(o+24+5,i,24,24),e.fillStyle="#fff",e.fillText("\uD83D\uDD04",o+24+5+12,i+16),a&&(e.fillStyle="#ff9800",e.fillRect(o+58,i,24,24),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(o+58,i,24,24),e.fillStyle="#fff",e.fillText("\uD83D\uDD17",o+58+12,i+16))}}if(s>=.4){let a=(n+x)/2,s=Math.abs(l-r)>Math.abs(x-n);if(e.fillStyle="#8B4513",e.font="10px Arial",e.textAlign="center",s){let a=i?Math.min(n,x)-50:Math.min(n,x)-8;e.fillText(`${(1e3*t.length).toFixed(0)}мм`,(r+l)/2,a)}else e.save(),e.translate(Math.min(r,l)-8,a),e.rotate(-Math.PI/2),e.fillText(`${(1e3*t.length).toFixed(0)}мм`,0,0),e.restore()}},eN=(e,t)=>{let i=Math.max(8,12*s),a=[{id:"nw",x:t.x-i/2,y:t.y-i/2},{id:"ne",x:t.x+t.width-i/2,y:t.y-i/2},{id:"sw",x:t.x-i/2,y:t.y+t.height-i/2},{id:"se",x:t.x+t.width-i/2,y:t.y+t.height-i/2},{id:"n",x:t.x+t.width/2-i/2,y:t.y-i/2},{id:"s",x:t.x+t.width/2-i/2,y:t.y+t.height-i/2},{id:"w",x:t.x-i/2,y:t.y+t.height/2-i/2},{id:"e",x:t.x+t.width-i/2,y:t.y+t.height/2-i/2}];e.fillStyle="#df682b",e.strokeStyle="#ffffff",e.lineWidth=1,a.forEach(t=>{e.fillRect(t.x,t.y,i,i),e.strokeRect(t.x,t.y,i,i)})},eS=(t,i)=>{let a,s;let o=M.find(e=>"house"===e.type);if(!o)return!1;let r=30*e.lotSize.width,n=30*e.lotSize.height;return C?(a=100,s=100):(a=o.x-50,s=o.y-50),t>=a&&t<=a+r&&i>=s&&i<=s+n},eD=(e,t)=>{let i=M.find(e=>"house"===e.type);if(!i)return!1;let a=i.x,s=i.y,o=i.width,r=i.height;return e>=a&&e<=a+o&&t>=s&&t<=s+r},eI=(e,t)=>{for(let i=S.length-1;i>=0;i--){let a=S[i];if(1.5>eT(e,t,a.x1,a.y1,a.x2,a.y2))return a}return null},eT=(e,t,i,a,s,o)=>{let r=e-i,n=t-a,l=s-i,x=o-a,c=l*l+x*x;if(0===c)return Math.sqrt(r*r+n*n);let b=Math.max(0,Math.min(1,(r*l+n*x)/c)),d=e-(i+b*l),f=t-(a+b*x);return Math.sqrt(d*d+f*f)},eC=(e,t)=>{for(let i=M.length-1;i>=0;i--){let a=M[i];if(e>=a.x&&e<=a.x+a.width&&t>=a.y&&t<=a.y+a.height)return a}return null},eW=(e,t,i)=>{let a=Math.max(8,12*s)+4,o=i.x*s,r=i.y*s,n=i.width*s,x=i.height*s;for(let i of[{id:"nw",x:o,y:r},{id:"ne",x:o+n,y:r},{id:"sw",x:o,y:r+x},{id:"se",x:o+n,y:r+x},{id:"n",x:o+n/2,y:r},{id:"s",x:o+n/2,y:r+x},{id:"w",x:o,y:r+x/2},{id:"e",x:o+n,y:r+x/2}]){let s=i.x+l.x,o=i.y+l.y;if(Math.abs(e-s)<=a&&Math.abs(t-o)<=a)return i.id}return null},eF=(e,t,i)=>{if(!i||void 0===i.x1)return null;let a=Math.max(6,8*s)+4,o=i.x1*s+l.x,r=i.y1*s+l.y,n=i.x2*s+l.x,x=i.y2*s+l.y;return Math.abs(e-o)<=a&&Math.abs(t-r)<=a?"start":Math.abs(e-n)<=a&&Math.abs(t-x)<=a?"end":null},eA=(e,t)=>{let i=S.find(e=>e.id===v.elementId);if(!i)return;let a=M.find(e=>"house"===e.type);if(!a)return;let s=Math.max(a.x,Math.min(a.x+a.width,e)),o=Math.max(a.y,Math.min(a.y+a.height,t)),r={...i};"start"===v.handle?(r.x1=s,r.y1=o):"end"===v.handle&&(r.x2=s,r.y2=o);let n=Math.sqrt(Math.pow(r.x2-r.x1,2)+Math.pow(r.y2-r.y1,2))/30;r.length=n,D(e=>e.map(e=>e.id===i.id?r:e)),w(r)},eE=(e,t)=>{if(v.isWall){eA(e,t);return}let i=M.find(e=>e.id===v.elementId);if(!i)return;let a=i.x,s=i.y,o=i.width,r=i.height;switch(v.handle){case"nw":o=i.x+i.width-e,r=i.y+i.height-t,a=e,s=t;break;case"ne":o=e-i.x,r=i.y+i.height-t,s=t;break;case"sw":o=i.x+i.width-e,r=t-i.y,a=e;break;case"se":o=e-i.x,r=t-i.y;break;case"n":r=i.y+i.height-t,s=t;break;case"s":r=t-i.y;break;case"w":o=i.x+i.width-e,a=e;break;case"e":o=e-i.x}o<30&&(v.handle.includes("w")&&(a=i.x+i.width-30),o=30),r<30&&(v.handle.includes("n")&&(s=i.y+i.height-30),r=30);let n=o/30,l=r/30;N(e=>e.map(e=>e.id===v.elementId?{...e,x:a,y:s,width:o,height:r,realWidth:Math.round(10*n)/10,realHeight:Math.round(10*l)/10}:e))},eR=(e,t)=>{let a=i.current;if(!a)return;let s="default";if("select"===p){if(s="grab",g){let i=eW(e,t,g),a=eF(e,t,g);i?s=({nw:"nw-resize",ne:"ne-resize",sw:"sw-resize",se:"se-resize",n:"n-resize",s:"s-resize",w:"w-resize",e:"e-resize"})[i]||"pointer":a&&(s="move")}b&&(s="grabbing")}else"wall"===p&&(s="crosshair");a.style.cursor=s},eP=e=>{let t=M.find(t=>t.id===e)||S.find(t=>t.id===e);if(t){if("house"===t.type){let t=M.map(t=>t.id===e?{...t,width:t.height,height:t.width,realWidth:t.realHeight,realHeight:t.realWidth}:t);N(t),eb({elements:t,walls:S})}else if(void 0!==t.x1){let i,a,s,o;let r=(t.x1+t.x2)/2,n=(t.y1+t.y2)/2,l=30*t.length;Math.abs(t.x2-t.x1)>Math.abs(t.y2-t.y1)?(i=r,a=n-l/2,s=r,o=n+l/2):(i=r-l/2,a=n,s=r+l/2,o=n);let x=S.map(t=>t.id===e?{...t,x1:i,y1:a,x2:s,y2:o}:t);D(x),eb({elements:M,walls:x})}}},eX=e=>{if(e.length<2)return!1;let t=e[0],i=Math.abs(t.x2-t.x1)>Math.abs(t.y2-t.y1);for(let t of e)if(Math.abs(t.x2-t.x1)>Math.abs(t.y2-t.y1)!==i)return!1;if(i){let i=t.y1;for(let t of e)if(Math.abs(t.y1-i)>5||Math.abs(t.y2-i)>5)return!1}else{let i=t.x1;for(let t of e)if(Math.abs(t.x1-i)>5||Math.abs(t.x2-i)>5)return!1}return!0},eY=e=>{let t=S.find(t=>t.id===e);if(!t)return;let i=[];if(S.forEach(a=>{if(a.id!==e&&Math.abs(t.x2-t.x1)>Math.abs(t.y2-t.y1)==Math.abs(a.x2-a.x1)>Math.abs(a.y2-a.y1)){let e=Math.sqrt(Math.pow(t.x2-a.x1,2)+Math.pow(t.y2-a.y1,2)),s=Math.sqrt(Math.pow(t.x1-a.x2,2)+Math.pow(t.y1-a.y2,2));(e<20||s<20)&&i.push(a)}}),i.length>0){let a=[t,...i],s=Math.min(...a.map(e=>Math.min(e.x1,e.x2))),o=Math.max(...a.map(e=>Math.max(e.x1,e.x2))),r=Math.min(...a.map(e=>Math.min(e.y1,e.y2))),n=Math.max(...a.map(e=>Math.max(e.y1,e.y2))),l=Math.abs(t.x2-t.x1)>Math.abs(t.y2-t.y1),x={...t,x1:l?s:t.x1,y1:l?t.y1:r,x2:l?o:t.x2,y2:l?t.y2:n,length:l?(o-s)/30:(n-r)/30},c=S.filter(t=>t.id!==e&&!i.some(e=>e.id===t.id));c.push(x),D(c),w(x),eb({elements:M,walls:c})}},e$=(e,t,i)=>{let a,o;let r=S.find(e=>e.id===i.wallId)||e2(i.wallId);if(!r)return!1;let n=Math.abs(r.x2-r.x1)>Math.abs(r.y2-r.y1),x=r.x1+(r.x2-r.x1)*i.position,c=r.y1+(r.y2-r.y1)*i.position;return n?(a=x*s+l.x-12,o=(c-i.width/2-("door"===i.type?25:35))*s+l.y):(a=(x-i.width/2-30)*s+l.x,o=c*s+l.y-10),e>=a&&e<=a+24&&t>=o&&t<=o+20&&("door"===i.type?ee(e=>e.filter(e=>e.id!==i.id)):ei(e=>e.filter(e=>e.id!==i.id)),w(null),!0)},eH=(e,t,i)=>{if(!i||"select"!==p)return!1;if(void 0!==i.x1){let a=i.x1*s+l.x,o=i.y1*s+l.y,r=i.x2*s+l.x,n=Math.min(o,i.y2*s+l.y)-40,x=S.some(e=>e.id!==i.id&&(5>Math.abs(e.x1-i.x1)&&5>Math.abs(e.y1-i.y1)||5>Math.abs(e.x2-i.x2)&&5>Math.abs(e.y2-i.y2)||5>Math.abs(e.x1-i.x2)&&5>Math.abs(e.y1-i.y2)||5>Math.abs(e.x2-i.x1)&&5>Math.abs(e.y2-i.y1))),c=x?3:2,b=(a+r)/2-(24*c+(c-1)*5)/2;if(e>=b&&e<=b+24&&t>=n&&t<=n+24)return eB(i.id),!0;if(e>=b+24+5&&e<=b+48+5&&t>=n&&t<=n+24)return eP(i.id),!0;if(x&&e>=b+58&&e<=b+72+10&&t>=n&&t<=n+24)return eY(i.id),!0}return!1},eB=e=>{let t=M.filter(t=>t.id!==e),i=S.filter(t=>t.id!==e),a=Q.filter(t=>t.id!==e),s=et.filter(t=>t.id!==e);N(t),D(i),ee(a),ei(s),w(null),eb({elements:t,walls:i,doors:a,windows:s})},eL=(e,t)=>{if(g&&t&&!(t<=0)&&"house"===g.type){let i="width"===e?t:g.realWidth,a="height"===e?t:g.realHeight,s=M.map(e=>e.id===g.id?{...e,width:30*i,height:30*a,realWidth:i,realHeight:a}:e);N(s),eb({elements:s,walls:S}),w(i=>({...i,width:("width"===e?t:i.realWidth)*30,height:("height"===e?t:i.realHeight)*30,realWidth:"width"===e?t:i.realWidth,realHeight:"height"===e?t:i.realHeight}))}},eq=e=>{let t,i,a,s;if(!g||void 0===g.x1||!e||e<=0)return;let o=M.find(e=>"house"===e.type);if(!o)return;let r=(g.x1+g.x2)/2,n=(g.y1+g.y2)/2,l=Math.abs(g.x2-g.x1)>Math.abs(g.y2-g.y1),x=30*e;l?(t=r-x/2,i=g.y1,a=r+x/2,s=g.y2):(t=g.x1,i=n-x/2,a=g.x2,s=n+x/2),t=Math.max(o.x,Math.min(o.x+o.width,t)),i=Math.max(o.y,Math.min(o.y+o.height,i)),a=Math.max(o.x,Math.min(o.x+o.width,a)),s=Math.max(o.y,Math.min(o.y+o.height,s));let c=Math.sqrt(Math.pow(a-t,2)+Math.pow(s-i,2))/30,b=S.map(e=>e.id===g.id?{...e,x1:t,y1:i,x2:a,y2:s,length:c}:e);D(b),eb({elements:M,walls:b}),w(e=>({...e,x1:t,y1:i,x2:a,y2:s,length:c}))},eO=e=>{if(!g||!e||e<=0)return;let t=30*e;"door"===g.type?(ee(Q.map(i=>i.id===g.id?{...i,width:t,realWidth:e}:i)),w(i=>({...i,width:t,realWidth:e}))):"window"===g.type&&(ei(et.map(i=>i.id===g.id?{...i,width:t,realWidth:e}:i)),w(i=>({...i,width:t,realWidth:e})))},e_=()=>{if(P&&Y&&H){let e=Math.sqrt(Math.pow(H.x-Y.x,2)+Math.pow(H.y-Y.y,2));if(e>15){let t=ey({id:Date.now(),x1:Y.x,y1:Y.y,x2:H.x,y2:H.y,length:e/30,thickness:.121,type:"interior"}),i=[...S,t];D(i),w(t),eb({elements:M,walls:i})}}X(!1),$(null),B(null),d(!1),k(null),z(null)},[eJ,eU]=(0,r.useState)(null),[eG,eK]=(0,r.useState)(null),eZ=(e,t)=>{let i=M.find(e=>"house"===e.type);if(!i)return null;let a=i.x,s=i.y,o=i.width,r=i.height;return 10>Math.abs(t-s)&&e>=a&&e<=a+o?{id:"house-top",x1:a,y1:s,x2:a+o,y2:s,type:"boundary"}:10>Math.abs(t-(s+r))&&e>=a&&e<=a+o?{id:"house-bottom",x1:a,y1:s+r,x2:a+o,y2:s+r,type:"boundary"}:10>Math.abs(e-a)&&t>=s&&t<=s+r?{id:"house-left",x1:a,y1:s,x2:a,y2:s+r,type:"boundary"}:10>Math.abs(e-(a+o))&&t>=s&&t<=s+r?{id:"house-right",x1:a+o,y1:s,x2:a+o,y2:s+r,type:"boundary"}:null},eV=(e,t,i,a)=>{try{let s;let o=Math.abs(e.x2-e.x1)>Math.abs(e.y2-e.y1),r=Math.sqrt(Math.pow(e.x2-e.x1,2)+Math.pow(e.y2-e.y1,2));s=o?(t-Math.min(e.x1,e.x2))/r:(i-Math.min(e.y1,e.y2))/r;let n="door"===a?24:45,l=[...Q.filter(t=>t.wallId===e.id),...et.filter(t=>t.wallId===e.id)],x=n/(2*r),c=10/r;for(let e of l){let t=e.width/(2*r),i=Math.abs(s-e.position),o=x+t+c;if(i<o){alert(`Нельзя разместить ${"door"===a?"дверь":"окно"} здесь - слишком близко к другому элементу`);return}}if(s-x<0||s+x>1){alert(`Нельзя разместить ${"door"===a?"дверь":"окно"} здесь - выходит за границы стены`);return}let b={id:Date.now(),wallId:e.id,position:s,width:n,realWidth:"door"===a?.8:1.5,type:a};"door"===a?(ee(e=>[...e,b]),eb({elements:M,walls:S,doors:[...Q,b],windows:et})):(ei(e=>[...e,b]),eb({elements:M,walls:S,doors:Q,windows:[...et,b]}))}catch(e){console.error("Ошибка при добавлении двери/окна:",e)}},eQ=e=>{let t={};Q.forEach(e=>{t[e.wallId]||(t[e.wallId]=[]),t[e.wallId].push(e)}),Object.entries(t).forEach(([t,i])=>{let a=S.find(e=>e.id===parseInt(t))||e2(t);if(!a)return;let o=Math.abs(a.x2-a.x1)>Math.abs(a.y2-a.y1);a.x2,a.x1,a.y2,a.y1,i.sort((e,t)=>e.position-t.position).forEach(t=>{let i=a.x1+(a.x2-a.x1)*t.position,r=a.y1+(a.y2-a.y1)*t.position;if(e.strokeStyle="#ffffff",e.lineWidth=Math.max(6,8*s),o){if(e.beginPath(),e.moveTo((i-t.width/2)*s,r*s),e.lineTo((i+t.width/2)*s,r*s),e.stroke(),e.fillStyle=g?.id===t.id?"#df682b":"#8B4513",e.fillRect((i-t.width/2+2)*s,(r-3)*s,(t.width-4)*s,6*s),e.strokeStyle=g?.id===t.id?"#df682b":"#666",e.lineWidth=g?.id===t.id?2:1,e.setLineDash([3,3]),e.beginPath(),e.arc(i*s,r*s,t.width/2*s,0,Math.PI),e.stroke(),e.setLineDash([]),e.fillStyle="#333",e.beginPath(),e.arc((i+t.width/3)*s,r*s,2,0,2*Math.PI),e.fill(),s>=.5&&(e.fillStyle="#8B4513",e.font="8px Arial",e.textAlign="center",e.fillText(`${(1e3*t.realWidth).toFixed(0)}мм`,i*s,(r-t.width/2-8)*s)),g?.id===t.id){let a=i*s-12,o=(r-t.width/2-25)*s;e.fillStyle="#ff4444",e.fillRect(a,o,24,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(a,o,24,20),e.fillStyle="#fff",e.font="14px Arial",e.textAlign="center",e.fillText("\uD83D\uDDD1️",a+12,o+14)}}else if(e.beginPath(),e.moveTo(i*s,(r-t.width/2)*s),e.lineTo(i*s,(r+t.width/2)*s),e.stroke(),e.fillStyle=g?.id===t.id?"#df682b":"#8B4513",e.fillRect((i-3)*s,(r-t.width/2+2)*s,6*s,(t.width-4)*s),e.strokeStyle=g?.id===t.id?"#df682b":"#666",e.lineWidth=g?.id===t.id?2:1,e.setLineDash([3,3]),e.beginPath(),e.arc(i*s,r*s,t.width/2*s,-Math.PI/2,Math.PI/2),e.stroke(),e.setLineDash([]),e.fillStyle="#333",e.beginPath(),e.arc(i*s,(r+t.width/3)*s,2,0,2*Math.PI),e.fill(),s>=.5&&(e.fillStyle="#8B4513",e.font="8px Arial",e.textAlign="center",e.save(),e.translate((i-t.width/2-12)*s,r*s),e.rotate(-Math.PI/2),e.fillText(`${(1e3*t.realWidth).toFixed(0)}мм`,0,0),e.restore()),g?.id===t.id){let a=(i-t.width/2-30)*s,o=r*s-10;e.fillStyle="#ff4444",e.fillRect(a,o,24,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(a,o,24,20),e.fillStyle="#fff",e.font="14px Arial",e.textAlign="center",e.fillText("\uD83D\uDDD1️",a+12,o+14)}})})},e0=e=>{let t={};et.forEach(e=>{t[e.wallId]||(t[e.wallId]=[]),t[e.wallId].push(e)}),Object.entries(t).forEach(([t,i])=>{let a=S.find(e=>e.id===parseInt(t))||e2(t);if(!a)return;let o=Math.abs(a.x2-a.x1)>Math.abs(a.y2-a.y1);a.x2,a.x1,a.y2,a.y1,i.sort((e,t)=>e.position-t.position).forEach(t=>{let i=a.x1+(a.x2-a.x1)*t.position,r=a.y1+(a.y2-a.y1)*t.position;if(e.strokeStyle="#ffffff",e.lineWidth=Math.max(6,8*s),o){if(e.beginPath(),e.moveTo((i-t.width/2)*s,r*s),e.lineTo((i+t.width/2)*s,r*s),e.stroke(),e.strokeStyle=g?.id===t.id?"#df682b":"#4169E1",e.lineWidth=g?.id===t.id?3:2,e.strokeRect((i-t.width/2)*s,(r-6)*s,t.width*s,12*s),e.strokeStyle=g?.id===t.id?"#df682b":"#4169E1",e.lineWidth=1,e.beginPath(),e.moveTo((i-t.width/2)*s,r*s),e.lineTo((i+t.width/2)*s,r*s),e.stroke(),e.beginPath(),e.moveTo(i*s,(r-6)*s),e.lineTo(i*s,(r+6)*s),e.stroke(),s>=.5&&(e.fillStyle="#4169E1",e.font="8px Arial",e.textAlign="center",e.fillText(`${(1e3*t.realWidth).toFixed(0)}мм`,i*s,(r-18)*s)),g?.id===t.id){let a=i*s-12,o=(r-t.width/2-35)*s;e.fillStyle="#ff4444",e.fillRect(a,o,24,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(a,o,24,20),e.fillStyle="#fff",e.font="14px Arial",e.textAlign="center",e.fillText("\uD83D\uDDD1️",a+12,o+14)}}else if(e.beginPath(),e.moveTo(i*s,(r-t.width/2)*s),e.lineTo(i*s,(r+t.width/2)*s),e.stroke(),e.strokeStyle=g?.id===t.id?"#df682b":"#4169E1",e.lineWidth=g?.id===t.id?3:2,e.strokeRect((i-6)*s,(r-t.width/2)*s,12*s,t.width*s),e.strokeStyle=g?.id===t.id?"#df682b":"#4169E1",e.lineWidth=1,e.beginPath(),e.moveTo((i-6)*s,r*s),e.lineTo((i+6)*s,r*s),e.stroke(),e.beginPath(),e.moveTo(i*s,(r-t.width/2)*s),e.lineTo(i*s,(r+t.width/2)*s),e.stroke(),s>=.5&&(e.fillStyle="#4169E1",e.font="8px Arial",e.textAlign="center",e.save(),e.translate((i-18)*s,r*s),e.rotate(-Math.PI/2),e.fillText(`${(1e3*t.realWidth).toFixed(0)}мм`,0,0),e.restore()),g?.id===t.id){let a=(i-t.width/2-30)*s,o=r*s-10;e.fillStyle="#ff4444",e.fillRect(a,o,24,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(a,o,24,20),e.fillStyle="#fff",e.font="14px Arial",e.textAlign="center",e.fillText("\uD83D\uDDD1️",a+12,o+14)}})})},e2=e=>{let t=M.find(e=>"house"===e.type);if(!t)return null;let i={"house-top":{x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y},"house-bottom":{x1:t.x,y1:t.y+t.height,x2:t.x+t.width,y2:t.y+t.height},"house-left":{x1:t.x,y1:t.y,x2:t.x,y2:t.y+t.height},"house-right":{x1:t.x+t.width,y1:t.y,x2:t.x+t.width,y2:t.y+t.height}};return i[e]?{id:e,...i[e],type:"boundary"}:null},e1=(e,t)=>{for(let i of Q){let a=S.find(e=>e.id===i.wallId)||e2(i.wallId);if(!a)continue;let s=a.x1+(a.x2-a.x1)*i.position,o=a.y1+(a.y2-a.y1)*i.position;if(Math.abs(e-s)<i.width/2&&Math.abs(t-o)<i.width/2)return i}return null},e8=(e,t)=>{for(let i of et){let a=S.find(e=>e.id===i.wallId)||e2(i.wallId);if(!a)continue;let s=a.x1+(a.x2-a.x1)*i.position,o=a.y1+(a.y2-a.y1)*i.position;if(Math.abs(e-s)<i.width/2&&Math.abs(t-o)<i.width/2)return i}return null},e4=(e,t,i,a)=>{let s;let o=S.find(t=>t.id===e.wallId)||e2(e.wallId);if(!o)return;let r=Math.abs(o.x2-o.x1)>Math.abs(o.y2-o.y1),n=Math.sqrt(Math.pow(o.x2-o.x1,2)+Math.pow(o.y2-o.y1,2));s=r?(t-Math.min(o.x1,o.x2))/n:(i-Math.min(o.y1,o.y2))/n;let l=[...Q.filter(t=>t.wallId===e.wallId&&t.id!==e.id),...et.filter(t=>t.wallId===e.wallId&&t.id!==e.id)],x=e.width/(2*n),c=10/n;for(let e of l){let t=e.width/(2*n);if(Math.abs(s-e.position)<x+t+c)return}s=Math.max(x,Math.min(1-x,s)),"door"===a?ee(t=>t.map(t=>t.id===e.id?{...t,position:s}:t)):ei(t=>t.map(t=>t.id===e.id?{...t,position:s}:t))};return(0,a.jsxs)(a.Fragment,{children:[u&&a.jsx(c,{elements:M,walls:S,doors:Q,windows:et,initialData:e,onClose:()=>y(!1)}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 constructor-interface fade-in",children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 constructor-header",children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 header-left",children:[a.jsx("button",{onClick:t,className:"jsx-964e21069faa8b83 back-btn",children:"⚙️ Настройки"}),a.jsx("h1",{className:"jsx-964e21069faa8b83",children:"Конструктор модульных домов"})]}),a.jsx("div",{className:"jsx-964e21069faa8b83 header-right",children:(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 project-info",children:[(0,a.jsxs)("span",{className:"jsx-964e21069faa8b83",children:["Дом: ",(1e3*e.house.width).toFixed(0),"\xd7",(1e3*e.house.height).toFixed(0),"мм"]}),(0,a.jsxs)("span",{className:"jsx-964e21069faa8b83",children:["Участок: ",(1e3*e.lotSize.width).toFixed(0),"\xd7",(1e3*e.lotSize.height).toFixed(0),"мм (",(e.lotSize.width*e.lotSize.height/100).toFixed(2)," соток)"]})]})})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 constructor-body",children:[a.jsx("div",{className:"jsx-964e21069faa8b83 workspace",children:a.jsx("canvas",{ref:i,onMouseDown:e=>{let t=i.current;if(!t)return;let a=t.getBoundingClientRect(),o=e.clientX-a.left,r=e.clientY-a.top,n=(o-l.x)/s,x=(r-l.y)/s;if("fix"===p){let e=eC(n,x),t=eI(n,x);if(e){I.has(e.id)?(T(t=>{let i=new Set(t);return i.delete(e.id),i}),R({id:e.id}),setTimeout(()=>R(null),2e3)):T(t=>new Set(t).add(e.id)),eo();return}if(t){I.has(t.id)?(T(e=>{let i=new Set(e);return i.delete(t.id),i}),R({id:t.id}),setTimeout(()=>R(null),2e3)):T(e=>new Set(e).add(t.id)),eo();return}if(eS(n,x)){C?(W(!1),R({type:"lot"}),setTimeout(()=>R(null),2e3)):W(!0),eo();return}}else if("wall"===p){eD(n,x)&&(X(!0),$({x:n,y:x}),B({x:n,y:x}));return}else if("door"===p||"window"===p){let e=eI(n,x)||eZ(n,x);e&&eV(e,n,x,p);return}else if("select"===p){if(g&&!I.has(g.id)){let e=eW(o,r,g);if(e){z({elementId:g.id,handle:e});return}let t=eF(o,r,g);if(t){z({elementId:g.id,handle:t,isWall:!0});return}}if(g&&eH(o,r,g)||g&&("door"===g.type||"window"===g.type)&&e$(o,r,g))return;let t=e1(n,x),i=e8(n,x),a=eI(n,x),s=eC(n,x),l=ej(n,x);if(t){w(t),k({element:t,startX:n,startY:x,type:"door"});return}if(i){w(i),k({element:i,startX:n,startY:x,type:"window"});return}if(a){e.ctrlKey?(es(e=>e.some(e=>e.id===a.id)?e.filter(e=>e.id!==a.id):[...e,a]),w(null)):(es([]),w(a),I.has(a.id)||k({element:a,startX:n,startY:x}));return}if(s){w(s),I.has(s.id)||k({element:s,startX:n-s.x,startY:x-s.y});return}else if(null!==l)return;e.ctrlKey||(w(null),es([]))}d(!0),h({x:e.clientX-l.x,y:e.clientY-l.y})},onMouseMove:t=>{let a=i.current;if(!a)return;let o=a.getBoundingClientRect(),r=t.clientX-o.left,n=t.clientY-o.top,c=(r-l.x)/s,d=(n-l.y)/s;if("fix"===p){a.style.cursor="pointer";let e=eC(c,d)||eI(c,d);e?A(e):eS(c,d)?A({type:"lot"}):A(null)}else if("select"===p){let e=eI(c,d),t=eC(c,d);e?(q(e),A(null),a.style.cursor="pointer"):t?(A(t),q(null),a.style.cursor="pointer"):(A(null),q(null),a.style.cursor="grab")}else A(null),q(null),a.style.cursor="wall"===p?"crosshair":"default";if(P&&Y){let e,t;Math.abs(c-Y.x)>Math.abs(d-Y.y)?(e=c,t=Y.y):(e=Y.x,t=d);let i=M.find(e=>"house"===e.type);i&&(e=Math.max(i.x,Math.min(i.x+i.width,e)),t=Math.max(i.y,Math.min(i.y+i.height,t))),B({x:e,y:t})}if(v&&!I.has(v.elementId)){eE(c,d);return}if(j&&"select"===p){if("door"===j.type)e4(j.element,c,d,"door");else if("window"===j.type)e4(j.element,c,d,"window");else if(!I.has(j.element.id)){if("house"===j.element.type){let t=c-j.startX,i=d-j.startY;if(C){let a=100/s,o=100/s,r=30*e.lotSize.width,n=30*e.lotSize.height;t=Math.max(a,Math.min(a+r-j.element.width,t)),i=Math.max(o,Math.min(o+n-j.element.height,i))}N(e=>e.map(e=>e.id===j.element.id?{...e,x:t,y:i}:e))}else if(void 0!==j.element.x1){let e=c-j.startX,t=d-j.startY;D(i=>i.map(i=>i.id===j.element.id?{...i,x1:i.x1+e,y1:i.y1+t,x2:i.x2+e,y2:i.y2+t}:i)),k({...j,startX:c,startY:d})}}return}b&&x({x:t.clientX-f.x,y:t.clientY-f.y}),eR(r,n)},onMouseUp:e_,onMouseLeave:e_,onDoubleClick:e=>{let t=i.current;if(!t)return;let a=t.getBoundingClientRect(),o=e.clientX-a.left,r=e.clientY-a.top,n=ej((o-l.x)/s,(r-l.y)/s);null!==n&&ev(n)},onWheel:e=>{e.preventDefault();let t=e.deltaY>0?.9:1.1;n(e=>Math.max(.3,Math.min(5,e*t)))},onTouchStart:e=>{if(e.preventDefault(),1===e.touches.length){let t=e.touches[0],a=i.current.getBoundingClientRect(),s=t.clientX-a.left,o=t.clientY-a.top,r=s-l.x,n=o-l.y;eK({x:t.clientX,y:t.clientY});let x=eC(r,n);x?(w(x),k({element:x,startX:r-x.x,startY:n-x.y})):(w(null),d(!0),h({x:t.clientX-l.x,y:t.clientY-l.y}))}else 2===e.touches.length&&(eU(Math.sqrt(Math.pow(e.touches[0].clientX-e.touches[1].clientX,2)+Math.pow(e.touches[0].clientY-e.touches[1].clientY,2))),d(!1),k(null))},onTouchMove:e=>{if(e.preventDefault(),1===e.touches.length){let t=e.touches[0],a=i.current.getBoundingClientRect(),s=t.clientX-a.left,o=t.clientY-a.top,r=s-l.x,n=o-l.y;if(j){let e=r-j.startX,t=n-j.startY;N(i=>i.map(i=>i.id===j.element.id?{...i,x:e,y:t}:i))}else b&&eG&&x({x:t.clientX-f.x,y:t.clientY-f.y})}else if(2===e.touches.length&&eJ){let t=Math.sqrt(Math.pow(e.touches[0].clientX-e.touches[1].clientX,2)+Math.pow(e.touches[0].clientY-e.touches[1].clientY,2)),i=t/eJ;n(e=>Math.max(.3,Math.min(5,e*i))),eU(t)}},onTouchEnd:()=>{d(!1),k(null),z(null),eU(null),eK(null)},className:"jsx-964e21069faa8b83"})}),(0,a.jsxs)("div",{className:`jsx-964e21069faa8b83 control-panel ${O?"collapsed":""}`,children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-header",children:[a.jsx("button",{title:"Отправить проект на расчет",onClick:()=>alert("Проект отправлен на расчет!"),className:"jsx-964e21069faa8b83 calculate-btn",children:"\uD83D\uDCCA Рассчитать проект"}),a.jsx("button",{title:"Свернуть",onClick:()=>_(!O),className:"jsx-964e21069faa8b83 collapse-btn",children:O?"◀":"▶"})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-section",children:[a.jsx("h3",{className:"jsx-964e21069faa8b83",children:"Режим просмотра"}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 view-toggle",children:[a.jsx("button",{onClick:()=>y(!1),className:"jsx-964e21069faa8b83 "+((u?"":"active")||""),children:"2D План"}),a.jsx("button",{onClick:()=>y(!0),className:"jsx-964e21069faa8b83 "+((u?"active":"")||""),children:"3D Вид"})]})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-section",children:[a.jsx("h3",{className:"jsx-964e21069faa8b83",children:"Инструменты"}),a.jsx("div",{className:"jsx-964e21069faa8b83 tools-grid",children:[{id:"select",name:"Выбор",icon:"\uD83D\uDC46"},{id:"wall",name:"Стена",icon:"\uD83E\uDDF1"},{id:"door",name:"Дверь",icon:"\uD83D\uDEAA"},{id:"window",name:"Окно",icon:"\uD83E\uDE9F"},{id:"fix",name:"Фиксация",icon:"\uD83D\uDD12"},{id:"rotate",name:"Поворот",icon:"\uD83D\uDD04"}].map(e=>(0,a.jsxs)("button",{onClick:()=>{"rotate"===e.id&&g?eP(g.id):m(e.id)},className:`jsx-964e21069faa8b83 tool-btn ${p===e.id?"active":""}`,children:[a.jsx("span",{className:"jsx-964e21069faa8b83 tool-icon",children:e.icon}),a.jsx("span",{className:"jsx-964e21069faa8b83 tool-name",children:e.name})]},e.id))}),ea.length>1&&a.jsx("div",{className:"jsx-964e21069faa8b83 merge-section",children:(0,a.jsxs)("button",{onClick:()=>{if(ea.length<2){alert("Выберите минимум 2 стены для объединения (удерживайте Ctrl и кликайте по стенам)");return}if(!eX(ea)){alert("Выбранные стены не могут быть объединены. Убедитесь, что они соединены и параллельны.");return}let e=ea[0],t=Math.abs(e.x2-e.x1)>Math.abs(e.y2-e.y1),i=1/0,a=-1/0,s=1/0,o=-1/0;ea.forEach(e=>{i=Math.min(i,e.x1,e.x2),a=Math.max(a,e.x1,e.x2),s=Math.min(s,e.y1,e.y2),o=Math.max(o,e.y1,e.y2)});let r={id:Date.now(),x1:t?i:e.x1,y1:t?e.y1:s,x2:t?a:e.x2,y2:t?e.y2:o,length:t?(a-i)/30:(o-s)/30,thickness:e.thickness,type:e.type},n=ea.map(e=>e.id),l=S.filter(e=>!n.includes(e.id));l.push(r),D(l),es([]),w(r),eb({elements:M,walls:l})},title:"Объединить выбранные стены",className:"jsx-964e21069faa8b83 merge-btn",children:["\uD83D\uDD17 Объединить стены (",ea.length,")"]})})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-section",children:[a.jsx("h3",{className:"jsx-964e21069faa8b83",children:"Управление"}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 zoom-controls",children:[a.jsx("button",{onClick:()=>n(e=>Math.min(5,1.2*e)),className:"jsx-964e21069faa8b83",children:"\uD83D\uDD0D+"}),(0,a.jsxs)("span",{className:"jsx-964e21069faa8b83",children:[Math.round(100*s),"%"]}),a.jsx("button",{onClick:()=>n(e=>Math.max(.3,e/1.2)),className:"jsx-964e21069faa8b83",children:"\uD83D\uDD0D-"}),a.jsx("button",{onClick:()=>{n(1),x({x:0,y:0})},className:"jsx-964e21069faa8b83",children:"\uD83C\uDFAF Сброс"})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 hotkeys-info",children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 hotkey-item",children:[a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Ctrl+Z"}),a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Отменить"})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 hotkey-item",children:[a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Enter"}),a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Подтвердить"})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 hotkey-item",children:[a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Delete"}),a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Удалить"})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 hotkey-item",children:[a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Ctrl+Click"}),a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Выбор стен"})]})]})]}),g&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-section",children:[a.jsx("h3",{className:"jsx-964e21069faa8b83",children:"Размеры элемента"}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 size-controls",children:[void 0!==g.realWidth&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 size-input",children:[a.jsx("label",{className:"jsx-964e21069faa8b83",children:"Ширина (мм):"}),a.jsx("input",{type:"number",min:"100",max:"50000",step:"10",value:Math.round(1e3*(g.realWidth||0)),onChange:e=>{let t=parseFloat(e.target.value);t&&t>0&&eL("width",t/1e3)},className:"jsx-964e21069faa8b83"})]}),void 0!==g.realHeight&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 size-input",children:[a.jsx("label",{className:"jsx-964e21069faa8b83",children:"Высота (мм):"}),a.jsx("input",{type:"number",min:"100",max:"50000",step:"10",value:Math.round(1e3*(g.realHeight||0)),onChange:e=>{let t=parseFloat(e.target.value);t&&t>0&&eL("height",t/1e3)},className:"jsx-964e21069faa8b83"})]}),void 0!==g.length&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 size-input",children:[a.jsx("label",{className:"jsx-964e21069faa8b83",children:"Длина (мм):"}),a.jsx("input",{type:"number",min:"100",max:"20000",step:"10",value:Math.round(1e3*(g.length||0)),onChange:e=>{let t=parseFloat(e.target.value);t&&t>0&&eq(t/1e3)},className:"jsx-964e21069faa8b83"})]}),("door"===g.type||"window"===g.type)&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 size-input",children:[a.jsx("label",{className:"jsx-964e21069faa8b83",children:"Ширина (мм):"}),a.jsx("input",{type:"number",min:"300",max:"3000",step:"50",value:Math.round(1e3*(g.realWidth||0)),onChange:e=>{let t=parseFloat(e.target.value);t&&t>0&&eO(t/1e3)},className:"jsx-964e21069faa8b83"})]})]})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-section",children:[a.jsx("h3",{className:"jsx-964e21069faa8b83",children:"Информация о проекте"}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 project-details",children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Название:"}),a.jsx("strong",{className:"jsx-964e21069faa8b83",children:e.house.title})]}),(()=>{let t=M.find(e=>"house"===e.type);return t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Размеры дома:"}),(0,a.jsxs)("strong",{className:"jsx-964e21069faa8b83",children:[(1e3*(t.realWidth||0)).toFixed(0),"\xd7",(1e3*(t.realHeight||0)).toFixed(0),"мм"]})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Площадь:"}),(0,a.jsxs)("strong",{className:"jsx-964e21069faa8b83",children:[((t.realWidth||0)*(t.realHeight||0)).toFixed(1),"м\xb2"]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Размеры дома:"}),(0,a.jsxs)("strong",{className:"jsx-964e21069faa8b83",children:[(1e3*e.house.width).toFixed(0),"\xd7",(1e3*e.house.height).toFixed(0),"мм"]})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Площадь:"}),(0,a.jsxs)("strong",{className:"jsx-964e21069faa8b83",children:[e.house.area,"м\xb2"]})]})]})})(),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Участок:"}),(0,a.jsxs)("strong",{className:"jsx-964e21069faa8b83",children:[(1e3*e.lotSize.width).toFixed(0),"\xd7",(1e3*e.lotSize.height).toFixed(0),"мм (",(e.lotSize.width*e.lotSize.height/100).toFixed(2)," соток)"]})]}),g&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item selected-info",children:[a.jsx("span",{className:"jsx-964e21069faa8b83",children:"Выбран:"}),a.jsx("strong",{className:"jsx-964e21069faa8b83",children:"house"===g.type?"Дом":"Элемент"})]})]})]})]}),O&&a.jsx("div",{className:"jsx-964e21069faa8b83 collapsed-panel",children:a.jsx("button",{onClick:()=>_(!1),title:"Развернуть панель",className:"jsx-964e21069faa8b83 expand-btn",children:"◀"})})]}),a.jsx(o(),{id:"964e21069faa8b83",children:".constructor-interface.jsx-964e21069faa8b83{width:100vw;height:100vh;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;background:var(--light-gray);-webkit-animation:fadeIn.5s ease-in-out;-moz-animation:fadeIn.5s ease-in-out;-o-animation:fadeIn.5s ease-in-out;animation:fadeIn.5s ease-in-out}@-webkit-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-o-keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.constructor-header.jsx-964e21069faa8b83{background:var(--primary-dark);color:var(--white);padding:8px 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-shadow:0 2px 8px rgba(0,0,0,.1);-moz-box-shadow:0 2px 8px rgba(0,0,0,.1);box-shadow:0 2px 8px rgba(0,0,0,.1);min-height:50px}.header-left.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:20px}.back-btn.jsx-964e21069faa8b83{background:var(--color-accent);color:var(--color-white);border:none;padding:6px 12px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;cursor:pointer;font-size:13px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.back-btn.jsx-964e21069faa8b83:hover{background:#c55a24}.constructor-header.jsx-964e21069faa8b83 h1.jsx-964e21069faa8b83{font-size:24px!important;margin:0;font-weight:500}.header-right.jsx-964e21069faa8b83 .project-info.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:12px;font-size:12px;opacity:.9}.constructor-body.jsx-964e21069faa8b83{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;overflow:hidden}.workspace.jsx-964e21069faa8b83{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;position:relative;background:#3a3b47}canvas.jsx-964e21069faa8b83{width:100%;height:100%;-ms-touch-action:-ms-none;-ms-touch-action:none;touch-action:none}.control-panel.jsx-964e21069faa8b83{width:280px;min-width:280px;max-width:280px;background:var(--primary-dark);color:var(--white);padding:12px;overflow-y:auto;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:12px;-webkit-transition:-webkit-transform.3s ease,width.3s ease;-moz-transition:-moz-transform.3s ease,width.3s ease;-o-transition:-o-transform.3s ease,width.3s ease;transition:-webkit-transform.3s ease,width.3s ease;transition:-moz-transform.3s ease,width.3s ease;transition:-o-transform.3s ease,width.3s ease;transition:transform.3s ease,width.3s ease;position:relative}.control-panel.collapsed.jsx-964e21069faa8b83{-webkit-transform:translatex(100%);-moz-transform:translatex(100%);-ms-transform:translatex(100%);-o-transform:translatex(100%);transform:translatex(100%);width:0;min-width:0;padding:0;overflow:hidden}.collapsed-panel.jsx-964e21069faa8b83{position:fixed;right:0;top:50%;-webkit-transform:translatey(-50%);-moz-transform:translatey(-50%);-ms-transform:translatey(-50%);-o-transform:translatey(-50%);transform:translatey(-50%);z-index:1000}.expand-btn.jsx-964e21069faa8b83{background:var(--primary-dark);color:var(--white);border:none;padding:20px 8px;-webkit-border-radius:8px 0 0 8px;-moz-border-radius:8px 0 0 8px;border-radius:8px 0 0 8px;cursor:pointer;font-size:20px;-webkit-box-shadow:-2px 0 8px rgba(0,0,0,.2);-moz-box-shadow:-2px 0 8px rgba(0,0,0,.2);box-shadow:-2px 0 8px rgba(0,0,0,.2);-webkit-transition:all.3s ease;-moz-transition:all.3s ease;-o-transition:all.3s ease;transition:all.3s ease}.expand-btn.jsx-964e21069faa8b83:hover{background:var(--accent-orange);padding-left:12px}.panel-header.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:8px;padding-bottom:8px;border-bottom:1px solid rgba(255,255,255,.2)}.calculate-btn.jsx-964e21069faa8b83{background:var(--color-accent);color:var(--color-white);border:none;padding:6px 10px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;cursor:pointer;font-size:11px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:4px}.calculate-btn.jsx-964e21069faa8b83:hover{background:#c55a24;-webkit-transform:translatey(-1px);-moz-transform:translatey(-1px);-ms-transform:translatey(-1px);-o-transform:translatey(-1px);transform:translatey(-1px)}.collapse-btn.jsx-964e21069faa8b83{background:transparent;color:var(--color-white);border:1px solid rgba(255,255,255,.3);padding:4px 6px;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;cursor:pointer;font-size:12px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.collapse-btn.jsx-964e21069faa8b83:hover{background:rgba(255,255,255,.1);border-color:var(--accent-orange)}.panel-section.jsx-964e21069faa8b83 h3.jsx-964e21069faa8b83{margin:0 0 8px 0;font-size:12px!important;color:var(--color-white);border-bottom:1px solid rgba(255,255,255,.2);padding-bottom:4px;font-weight:500}.view-toggle.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;background:rgba(255,255,255,.1);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;overflow:hidden}.view-toggle.jsx-964e21069faa8b83 button.jsx-964e21069faa8b83{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;padding:8px 10px;border:none;background:transparent;color:var(--color-white);cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;font-size:12px}.view-toggle.jsx-964e21069faa8b83 button.active.jsx-964e21069faa8b83{background:var(--accent-orange)}.tools-grid.jsx-964e21069faa8b83{display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px}.tool-btn.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:2px;padding:8px 4px;border:1px solid rgba(255,255,255,.2);background:transparent;color:var(--color-white);-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.tool-btn.jsx-964e21069faa8b83:hover{background:rgba(255,255,255,.1)}.tool-btn.active.jsx-964e21069faa8b83{background:var(--accent-orange);border-color:var(--accent-orange)}.tool-icon.jsx-964e21069faa8b83{font-size:16px}.tool-name.jsx-964e21069faa8b83{font-size:10px}.zoom-controls.jsx-964e21069faa8b83{display:grid;grid-template-columns:1fr auto 1fr 1fr;gap:4px;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.zoom-controls.jsx-964e21069faa8b83 button.jsx-964e21069faa8b83{padding:6px 8px;border:1px solid rgba(255,255,255,.2);background:transparent;color:var(--color-white);-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;font-size:11px}.zoom-controls.jsx-964e21069faa8b83 button.jsx-964e21069faa8b83:hover{background:rgba(255,255,255,.1)}.zoom-controls.jsx-964e21069faa8b83 span.jsx-964e21069faa8b83{text-align:center;font-size:11px}.hotkeys-info.jsx-964e21069faa8b83{margin-top:8px;padding-top:8px;border-top:1px solid rgba(255,255,255,.1)}.hotkey-item.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:2px 0;font-size:9px}.hotkey-item.jsx-964e21069faa8b83 span.jsx-964e21069faa8b83:first-child{background:rgba(255,255,255,.1);padding:1px 4px;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;font-family:monospace;font-size:8px}.project-details.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:4px}.detail-item.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:4px 0;border-bottom:1px solid rgba(255,255,255,.1);font-size:11px}.detail-item.jsx-964e21069faa8b83 span.jsx-964e21069faa8b83{opacity:.8}.detail-item.jsx-964e21069faa8b83 strong.jsx-964e21069faa8b83{color:var(--accent-orange)}.selected-info.jsx-964e21069faa8b83{background:rgba(223,104,43,.1);padding:2px 6px;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;margin:2px 0}.size-controls.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:6px}.size-input.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:2px}.size-input.jsx-964e21069faa8b83 label.jsx-964e21069faa8b83{font-size:10px;opacity:.8}.size-input.jsx-964e21069faa8b83 input.jsx-964e21069faa8b83{padding:4px 6px;border:1px solid rgba(255,255,255,.2);-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;background:rgba(255,255,255,.1);color:var(--color-white);font-size:11px}.size-input.jsx-964e21069faa8b83 input.jsx-964e21069faa8b83:focus{outline:none;border-color:var(--accent-orange);background:rgba(255,255,255,.15)}.merge-section.jsx-964e21069faa8b83{margin-top:8px;padding-top:8px;border-top:1px solid rgba(255,255,255,.2)}.merge-btn.jsx-964e21069faa8b83{width:100%;padding:8px 12px;background:var(--color-accent);color:var(--color-white);border:none;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;cursor:pointer;font-size:11px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;gap:4px}.merge-btn.jsx-964e21069faa8b83:hover{background:#c55a24;-webkit-transform:translatey(-1px);-moz-transform:translatey(-1px);-ms-transform:translatey(-1px);-o-transform:translatey(-1px);transform:translatey(-1px)}@media(max-width:768px){.constructor-header.jsx-964e21069faa8b83{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:12px;padding:12px 16px}.header-left.jsx-964e21069faa8b83{width:100%;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.header-right.jsx-964e21069faa8b83 .project-info.jsx-964e21069faa8b83{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:4px;text-align:center}.constructor-body.jsx-964e21069faa8b83{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.control-panel.jsx-964e21069faa8b83{width:100%;min-width:auto;max-width:none;height:40%;padding:16px;gap:16px;-webkit-transform:none;-moz-transform:none;-ms-transform:none;-o-transform:none;transform:none}.control-panel.collapsed.jsx-964e21069faa8b83{-webkit-transform:translatey(100%);-moz-transform:translatey(100%);-ms-transform:translatey(100%);-o-transform:translatey(100%);transform:translatey(100%);height:0;padding:0}.collapsed-panel.jsx-964e21069faa8b83{position:fixed;bottom:0;left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);right:auto;top:auto}.expand-btn.jsx-964e21069faa8b83{-webkit-border-radius:8px 8px 0 0;-moz-border-radius:8px 8px 0 0;border-radius:8px 8px 0 0;padding:8px 20px}.panel-header.jsx-964e21069faa8b83{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:8px}.calculate-btn.jsx-964e21069faa8b83{width:100%;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.workspace.jsx-964e21069faa8b83{height:60%}.tools-grid.jsx-964e21069faa8b83{grid-template-columns:repeat(3,1fr)}.zoom-controls.jsx-964e21069faa8b83{grid-template-columns:repeat(4,1fr)}}"})]})]})}let d=function(){let[e,t]=(0,r.useState)(!0),[i,s]=(0,r.useState)(null),[n,x]=(0,r.useState)(!0);return n?(0,a.jsxs)("div",{className:"jsx-bb5537eae6442a17 constructor-loading",children:[(0,a.jsxs)("div",{className:"jsx-bb5537eae6442a17 loading-content",children:[a.jsx("div",{className:"jsx-bb5537eae6442a17 spinner"}),a.jsx("p",{className:"jsx-bb5537eae6442a17",children:"Загрузка конструктора..."})]}),a.jsx(o(),{id:"bb5537eae6442a17",children:".constructor-loading.jsx-bb5537eae6442a17{position:fixed;top:0;left:0;width:100vw;height:100vh;background:var(--primary-dark);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;z-index:9999}.loading-content.jsx-bb5537eae6442a17{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:20px;color:var(--white)}.spinner.jsx-bb5537eae6442a17{width:50px;height:50px;border:4px solid rgba(255,255,255,.1);border-top:4px solid var(--accent-orange);-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;-webkit-animation:spin 1s linear infinite;-moz-animation:spin 1s linear infinite;-o-animation:spin 1s linear infinite;animation:spin 1s linear infinite}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}.loading-content.jsx-bb5537eae6442a17 p.jsx-bb5537eae6442a17{font-size:16px;margin:0;opacity:.9}"})]}):e?a.jsx(l,{onComplete:e=>{s(e),t(!1)}}):a.jsx(b,{initialData:i,onBack:()=>{t(!0)}})}},5937:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var a=i(997);i(108);var s=i(4298),o=i.n(s),r=i(6689);let n=()=>{let e=function(){let[e,t]=(0,r.useState)(!1);return e}(),t=process.env.NEXT_PUBLIC_GA_ID,i=process.env.NEXT_PUBLIC_YANDEX_METRICA_ID;return e?(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(o(),{src:`https://www.googletagmanager.com/gtag/js?id=${t}`,strategy:"afterInteractive"}),a.jsx(o(),{id:"google-analytics",strategy:"afterInteractive",children:`
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', '${t}', {
                page_title: document.title,
                page_location: window.location.href,
              });
            `})]}),i&&a.jsx(o(),{id:"yandex-metrica",strategy:"afterInteractive",children:`
            (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
            m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
            (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
            
            ym(${i}, "init", {
              clickmap:true,
              trackLinks:true,
              accurateTrackBounce:true,
              webvisor:true
            });
          `})]}):null};function l({Component:e,pageProps:t}){return(0,a.jsxs)(a.Fragment,{children:[a.jsx(e,{...t}),a.jsx(n,{})]})}},9981:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var a=i(997),s=i(6859);function o(){return(0,a.jsxs)(s.Html,{lang:"ru",children:[(0,a.jsxs)(s.Head,{children:[a.jsx("meta",{charSet:"utf-8"}),a.jsx("link",{rel:"icon",href:"/favicon-house.ico"}),a.jsx("link",{rel:"icon",type:"image/svg+xml",href:"/house-icon.svg"}),a.jsx("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/house-icon.svg"}),a.jsx("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"/house-icon.svg"}),a.jsx("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"/house-icon.svg"}),a.jsx("link",{rel:"manifest",href:"/manifest.json"}),a.jsx("meta",{name:"theme-color",content:"#007bff"}),a.jsx("meta",{name:"msapplication-TileColor",content:"#007bff"}),a.jsx("meta",{name:"robots",content:"index, follow"}),a.jsx("meta",{name:"author",content:"Easy House"}),a.jsx("meta",{name:"format-detection",content:"telephone=no"}),a.jsx("meta",{name:"mobile-web-app-capable",content:"yes"}),a.jsx("meta",{name:"apple-mobile-web-app-capable",content:"yes"}),a.jsx("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"}),a.jsx("meta",{name:"apple-mobile-web-app-title",content:"Easy House"}),a.jsx("meta",{name:"application-name",content:"Easy House"}),a.jsx("meta",{name:"msapplication-tooltip",content:"Модульные дома под ключ"}),a.jsx("meta",{name:"msapplication-starturl",content:"/"}),a.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),a.jsx("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"}),a.jsx("link",{rel:"dns-prefetch",href:"//www.google-analytics.com"}),a.jsx("link",{rel:"dns-prefetch",href:"//mc.yandex.ru"}),a.jsx("script",{type:"text/javascript",dangerouslySetInnerHTML:{__html:`
            (function(m,e,t,r,i,k,a){
                m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
                m[i].l=1*new Date();
                for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
                k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
            })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=104007659', 'ym');

            ym(104007659, 'init', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
          `}}),a.jsx("noscript",{children:a.jsx("div",{children:a.jsx("img",{src:"https://mc.yandex.ru/watch/104007659",style:{position:"absolute",left:"-9999px"},alt:""})})})]}),(0,a.jsxs)("body",{children:[a.jsx(s.Main,{}),a.jsx(s.NextScript,{})]})]})}},108:()=>{}};