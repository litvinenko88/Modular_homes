"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[423],{3083:function(e,t,i){i.d(t,{Z:function(){return d}});var a=i(5893),o=i(645),s=i.n(o),r=i(7294);let n={arkhangelsk:{name:'Серия "Архангельск"',icon:"\uD83C\uDFE0",models:[{id:"arch-6x2.5",width:6,height:2.5,title:"Новый Архангельск",area:15,price:45e4},{id:"arch-7x2.5",width:7,height:2.5,title:"Новый Архангельск",area:17.5,price:525e3},{id:"arch-8x2.5",width:8,height:2.5,title:"Новый Архангельск",area:20,price:6e5},{id:"arch-6x5",width:6,height:5,title:"Угловой Архангельск",area:30,price:9e5},{id:"arch-7x5",width:7,height:5,title:"Угловой Архангельск",area:35,price:105e4},{id:"arch-8x5",width:8,height:5,title:"Угловой Архангельск",area:40,price:12e5}]},barn:{name:'Серия "Барн"',icon:"\uD83C\uDFD8️",models:[{id:"barn-6x2.5",width:6,height:2.5,title:"Барнхаус",area:15,price:48e4},{id:"barn-7x2.5",width:7,height:2.5,title:"Барнхаус",area:17.5,price:56e4},{id:"barn-8x2.5",width:8,height:2.5,title:"Барнхаус",area:20,price:64e4},{id:"barn-6x5",width:6,height:5,title:"Барн с террасой",area:30,price:96e4},{id:"barn-7x5",width:7,height:5,title:"Барн с террасой",area:35,price:112e4},{id:"barn-8x5",width:8,height:5,title:"Барн с террасой",area:40,price:128e4}]},multi:{name:"Многомодульные решения",icon:"\uD83C\uDFE2",models:[{id:"dvin-6x5",width:6,height:5,title:"Двухмодульная Двинея",area:30,price:9e5},{id:"dvin-7x5",width:7,height:5,title:"Двухмодульная Двинея",area:35,price:105e4},{id:"dvin-8x5",width:8,height:5,title:"Двухмодульная Двинея",area:40,price:12e5},{id:"barn4-7x10",width:7,height:10,title:"Четырехмодульный Барн",area:70,price:21e5},{id:"barn4-8x10",width:8,height:10,title:"Четырехмодульный Барн",area:80,price:24e5}]}};function l(e){let{onComplete:t}=e,[i,o]=(0,r.useState)(null),[l,x]=(0,r.useState)(!1),[b,c]=(0,r.useState)(6),[d,f]=(0,r.useState)(2.5),[h,p]=(0,r.useState)(20),[m,u]=(0,r.useState)(15),[y,g]=(0,r.useState)("arkhangelsk"),w=(i||l)&&h>0&&m>0,k=e=>{o(e),x(!1)};return(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 modal-overlay fade-in",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 modal-container slide-in",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 modal-header",children:[(0,a.jsx)("h2",{className:"jsx-28bcee4bb7cc19b0",children:"Настройка конструктора"}),(0,a.jsx)("p",{className:"jsx-28bcee4bb7cc19b0",children:"Выберите размер дома и участка для начала проектирования"})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 modal-content",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 section",children:[(0,a.jsxs)("h3",{className:"jsx-28bcee4bb7cc19b0",children:[(0,a.jsx)("span",{className:"jsx-28bcee4bb7cc19b0 section-icon",children:"\uD83D\uDCD0"}),"Размеры участка"]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 lot-inputs",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 input-group",children:[(0,a.jsx)("label",{className:"jsx-28bcee4bb7cc19b0",children:"Ширина участка (м)"}),(0,a.jsx)("input",{type:"number",value:h,onChange:e=>p(Number(e.target.value)),min:"10",max:"100",className:"jsx-28bcee4bb7cc19b0"})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 input-group",children:[(0,a.jsx)("label",{className:"jsx-28bcee4bb7cc19b0",children:"Длина участка (м)"}),(0,a.jsx)("input",{type:"number",value:m,onChange:e=>u(Number(e.target.value)),min:"10",max:"100",className:"jsx-28bcee4bb7cc19b0"})]})]})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 section",children:[(0,a.jsxs)("h3",{className:"jsx-28bcee4bb7cc19b0",children:[(0,a.jsx)("span",{className:"jsx-28bcee4bb7cc19b0 section-icon",children:"\uD83C\uDFE0"}),"Выбор дома"]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 house-selection-tabs",children:[(0,a.jsx)("button",{onClick:()=>x(!1),className:"jsx-28bcee4bb7cc19b0 "+((l?"":"active")||""),children:"Готовые проекты"}),(0,a.jsx)("button",{onClick:()=>{x(!0),o(null)},className:"jsx-28bcee4bb7cc19b0 "+((l?"active":"")||""),children:"Свои размеры"})]}),l?(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 custom-house",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 custom-visual",children:[(0,a.jsx)("div",{className:"jsx-28bcee4bb7cc19b0 custom-icon",children:"\uD83D\uDCCF"}),(0,a.jsx)("h4",{className:"jsx-28bcee4bb7cc19b0",children:"Индивидуальный размер"})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 custom-inputs",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 input-group",children:[(0,a.jsx)("label",{className:"jsx-28bcee4bb7cc19b0",children:"Ширина дома (м)"}),(0,a.jsx)("input",{type:"number",value:b,onChange:e=>c(Number(e.target.value)),min:"2",max:"20",step:"0.5",className:"jsx-28bcee4bb7cc19b0"})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 input-group",children:[(0,a.jsx)("label",{className:"jsx-28bcee4bb7cc19b0",children:"Длина дома (м)"}),(0,a.jsx)("input",{type:"number",value:d,onChange:e=>f(Number(e.target.value)),min:"2",max:"30",step:"0.5",className:"jsx-28bcee4bb7cc19b0"})]})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 custom-info",children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 info-item",children:[(0,a.jsx)("span",{className:"jsx-28bcee4bb7cc19b0",children:"Площадь:"}),(0,a.jsxs)("strong",{className:"jsx-28bcee4bb7cc19b0",children:[(b*d).toFixed(1),"м\xb2"]})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 info-item",children:[(0,a.jsx)("span",{className:"jsx-28bcee4bb7cc19b0",children:"Примерная стоимость:"}),(0,a.jsxs)("strong",{className:"jsx-28bcee4bb7cc19b0",children:[(b*d*30).toFixed(0),"к ₽"]})]})]})]}):(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 preset-houses",children:[(0,a.jsx)("div",{className:"jsx-28bcee4bb7cc19b0 series-selector",children:Object.entries(n).map(e=>{let[t,i]=e;return(0,a.jsxs)("button",{onClick:()=>g(t),className:"jsx-28bcee4bb7cc19b0 "+((y===t?"active":"")||""),children:[(0,a.jsx)("span",{className:"jsx-28bcee4bb7cc19b0 series-icon",children:i.icon}),i.name]},t)})}),(0,a.jsx)("div",{className:"jsx-28bcee4bb7cc19b0 houses-grid",children:n[y].models.map(e=>(0,a.jsxs)("div",{onClick:()=>k(e),className:"jsx-28bcee4bb7cc19b0 "+"house-card ".concat((null==i?void 0:i.id)===e.id?"selected":""),children:[(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 house-visual",children:[(0,a.jsx)("div",{className:"jsx-28bcee4bb7cc19b0 house-icon",children:"\uD83C\uDFE0"}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 house-dimensions",children:[e.width,"\xd7",e.height,"м"]})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 house-info",children:[(0,a.jsx)("h4",{className:"jsx-28bcee4bb7cc19b0",children:e.title}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 house-specs",children:[(0,a.jsxs)("span",{className:"jsx-28bcee4bb7cc19b0 area",children:[e.area,"м\xb2"]}),(0,a.jsxs)("span",{className:"jsx-28bcee4bb7cc19b0 price",children:[(e.price/1e3).toFixed(0),"к ₽"]})]})]})]},e.id))})]})]})]}),(0,a.jsxs)("div",{className:"jsx-28bcee4bb7cc19b0 modal-footer",children:[(0,a.jsx)("button",{onClick:()=>{t({house:l?{id:"custom-".concat(Date.now()),width:b,height:d,area:b*d,price:b*d*3e4,title:"Модуль ".concat(b,"\xd7").concat(d,"м")}:i,lotSize:{width:h,height:m}})},disabled:!w,className:"jsx-28bcee4bb7cc19b0 proceed-btn",children:"Перейти к конструктору"}),!w&&(0,a.jsx)("p",{className:"jsx-28bcee4bb7cc19b0 warning",children:"Выберите размер дома и укажите размеры участка"})]})]}),(0,a.jsx)(s(),{id:"28bcee4bb7cc19b0",children:'.modal-overlay.jsx-28bcee4bb7cc19b0{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,.7);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;z-index:1000;padding:20px;-webkit-animation:fadeIn.3s ease-in-out;-moz-animation:fadeIn.3s ease-in-out;-o-animation:fadeIn.3s ease-in-out;animation:fadeIn.3s ease-in-out}@-webkit-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-o-keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@-webkit-keyframes slideIn{from{-webkit-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-webkit-transform:translatey(0);transform:translatey(0);opacity:1}}@-moz-keyframes slideIn{from{-moz-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-moz-transform:translatey(0);transform:translatey(0);opacity:1}}@-o-keyframes slideIn{from{-o-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-o-transform:translatey(0);transform:translatey(0);opacity:1}}@keyframes slideIn{from{-webkit-transform:translatey(-20px);-moz-transform:translatey(-20px);-o-transform:translatey(-20px);transform:translatey(-20px);opacity:0}to{-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0);opacity:1}}.modal-container.jsx-28bcee4bb7cc19b0{background:var(--white);-webkit-border-radius:16px;-moz-border-radius:16px;border-radius:16px;max-width:1e3px;width:100%;max-height:95vh;overflow-y:auto;-webkit-box-shadow:0 25px 50px rgba(0,0,0,.25);-moz-box-shadow:0 25px 50px rgba(0,0,0,.25);box-shadow:0 25px 50px rgba(0,0,0,.25);-webkit-animation:slideIn.4s ease-out;-moz-animation:slideIn.4s ease-out;-o-animation:slideIn.4s ease-out;animation:slideIn.4s ease-out}.modal-header.jsx-28bcee4bb7cc19b0{background:-webkit-linear-gradient(315deg,var(--color-primary)0%,rgba(49,50,61,.95)100%);background:-moz-linear-gradient(315deg,var(--color-primary)0%,rgba(49,50,61,.95)100%);background:-o-linear-gradient(315deg,var(--color-primary)0%,rgba(49,50,61,.95)100%);background:linear-gradient(135deg,var(--color-primary)0%,rgba(49,50,61,.95)100%);color:var(--white);padding:32px 24px;-webkit-border-radius:16px 16px 0 0;-moz-border-radius:16px 16px 0 0;border-radius:16px 16px 0 0;text-align:center;position:relative;overflow:hidden}.modal-header.jsx-28bcee4bb7cc19b0::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:-webkit-linear-gradient(45deg,rgba(223,104,43,.1)0%,transparent 50%);background:-moz-linear-gradient(45deg,rgba(223,104,43,.1)0%,transparent 50%);background:-o-linear-gradient(45deg,rgba(223,104,43,.1)0%,transparent 50%);background:linear-gradient(45deg,rgba(223,104,43,.1)0%,transparent 50%);z-index:1}.modal-header.jsx-28bcee4bb7cc19b0 h2.jsx-28bcee4bb7cc19b0{font-size:28px;margin-bottom:8px;font-weight:700;position:relative;z-index:2}.modal-header.jsx-28bcee4bb7cc19b0 p.jsx-28bcee4bb7cc19b0{opacity:.9;font-size:16px;margin:0;position:relative;z-index:2}.modal-content.jsx-28bcee4bb7cc19b0{padding:32px 24px}.section.jsx-28bcee4bb7cc19b0{margin-bottom:32px}.section.jsx-28bcee4bb7cc19b0 h3.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:12px;font-size:20px;margin-bottom:20px;color:var(--color-primary);font-weight:600}.section-icon.jsx-28bcee4bb7cc19b0{font-size:16px}.lot-inputs.jsx-28bcee4bb7cc19b0{display:grid;grid-template-columns:1fr 1fr;gap:12px}.input-group.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:4px}.input-group.jsx-28bcee4bb7cc19b0 label.jsx-28bcee4bb7cc19b0{font-weight:500;color:var(--text-dark);font-size:12px}.input-group.jsx-28bcee4bb7cc19b0 input.jsx-28bcee4bb7cc19b0{padding:8px 10px;border:1px solid var(--border-gray);-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;font-size:13px;-webkit-transition:border-color.2s;-moz-transition:border-color.2s;-o-transition:border-color.2s;transition:border-color.2s}.input-group.jsx-28bcee4bb7cc19b0 input.jsx-28bcee4bb7cc19b0:focus{outline:none;border-color:var(--accent-orange)}.house-selection-tabs.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;background:var(--light-purple);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;padding:3px;margin-bottom:12px}.house-selection-tabs.jsx-28bcee4bb7cc19b0 button.jsx-28bcee4bb7cc19b0{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;padding:8px 10px;border:none;background:transparent;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;cursor:pointer;font-weight:500;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;font-size:12px}.house-selection-tabs.jsx-28bcee4bb7cc19b0 button.active.jsx-28bcee4bb7cc19b0{background:var(--accent-orange);color:var(--white)}.series-selector.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:6px;margin-bottom:12px;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.series-selector.jsx-28bcee4bb7cc19b0 button.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:6px;padding:6px 12px;border:1px solid var(--border-gray);background:var(--white);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;font-size:11px}.series-selector.jsx-28bcee4bb7cc19b0 button.active.jsx-28bcee4bb7cc19b0{border-color:var(--accent-orange);background:var(--light-purple)}.series-icon.jsx-28bcee4bb7cc19b0{font-size:14px}.houses-grid.jsx-28bcee4bb7cc19b0{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}.house-card.jsx-28bcee4bb7cc19b0{border:2px solid#e5e7eb;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:16px;cursor:pointer;-webkit-transition:all.3s cubic-bezier(.4,0,.2,1);-moz-transition:all.3s cubic-bezier(.4,0,.2,1);-o-transition:all.3s cubic-bezier(.4,0,.2,1);transition:all.3s cubic-bezier(.4,0,.2,1);background:var(--color-white);position:relative;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%;min-height:140px}.house-card.jsx-28bcee4bb7cc19b0::before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:-webkit-linear-gradient(315deg,rgba(223,104,43,.05)0%,transparent 50%);background:-moz-linear-gradient(315deg,rgba(223,104,43,.05)0%,transparent 50%);background:-o-linear-gradient(315deg,rgba(223,104,43,.05)0%,transparent 50%);background:linear-gradient(135deg,rgba(223,104,43,.05)0%,transparent 50%);opacity:0;-webkit-transition:opacity.3s;-moz-transition:opacity.3s;-o-transition:opacity.3s;transition:opacity.3s}.house-card.jsx-28bcee4bb7cc19b0:hover{border-color:var(--color-accent);-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-ms-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px);-webkit-box-shadow:0 8px 16px rgba(223,104,43,.15);-moz-box-shadow:0 8px 16px rgba(223,104,43,.15);box-shadow:0 8px 16px rgba(223,104,43,.15)}.house-card.jsx-28bcee4bb7cc19b0:hover::before{opacity:1}.house-card.selected.jsx-28bcee4bb7cc19b0{border-color:var(--color-accent);background:-webkit-linear-gradient(315deg,rgba(223,104,43,.08)0%,rgba(223,104,43,.03)100%);background:-moz-linear-gradient(315deg,rgba(223,104,43,.08)0%,rgba(223,104,43,.03)100%);background:-o-linear-gradient(315deg,rgba(223,104,43,.08)0%,rgba(223,104,43,.03)100%);background:linear-gradient(135deg,rgba(223,104,43,.08)0%,rgba(223,104,43,.03)100%);-webkit-box-shadow:0 6px 16px rgba(223,104,43,.2);-moz-box-shadow:0 6px 16px rgba(223,104,43,.2);box-shadow:0 6px 16px rgba(223,104,43,.2)}.house-card.selected.jsx-28bcee4bb7cc19b0::after{content:"✓";position:absolute;top:8px;right:8px;width:20px;height:20px;background:var(--color-accent);color:var(--color-white);-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;font-size:12px;font-weight:bold;z-index:3}.house-visual.jsx-28bcee4bb7cc19b0{text-align:center;margin-bottom:12px;position:relative;z-index:2;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.house-icon.jsx-28bcee4bb7cc19b0{font-size:28px;margin-bottom:6px;-webkit-filter:drop-shadow(0 2px 4px rgba(0,0,0,.1));filter:drop-shadow(0 2px 4px rgba(0,0,0,.1));display:block}.house-dimensions.jsx-28bcee4bb7cc19b0{font-weight:600;color:var(--color-accent);font-size:14px;background:rgba(223,104,43,.1);padding:3px 8px;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;display:inline-block;white-space:nowrap}.house-info.jsx-28bcee4bb7cc19b0{position:relative;z-index:2;-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.house-info.jsx-28bcee4bb7cc19b0 h4.jsx-28bcee4bb7cc19b0{font-size:12px;margin-bottom:8px;color:var(--color-primary);font-weight:600;line-height:1.3;white-space:normal;overflow:visible;-o-text-overflow:unset;text-overflow:unset;min-height:32px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.house-specs.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;font-size:11px;font-weight:500;gap:6px;margin-top:auto}.house-specs.jsx-28bcee4bb7cc19b0 .area.jsx-28bcee4bb7cc19b0{color:var(--color-primary);background:rgba(49,50,61,.1);padding:2px 6px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;white-space:nowrap;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.house-specs.jsx-28bcee4bb7cc19b0 .price.jsx-28bcee4bb7cc19b0{color:var(--color-accent);background:rgba(223,104,43,.1);padding:2px 6px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;white-space:nowrap;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;font-weight:600}.custom-house.jsx-28bcee4bb7cc19b0{border:1px solid var(--border-gray);-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;padding:14px;background:var(--light-purple)}.custom-visual.jsx-28bcee4bb7cc19b0{text-align:center;margin-bottom:12px}.custom-icon.jsx-28bcee4bb7cc19b0{font-size:24px;margin-bottom:4px}.custom-inputs.jsx-28bcee4bb7cc19b0{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:12px}.custom-info.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:8px;background:var(--white);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px}.info-item.jsx-28bcee4bb7cc19b0{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:2px;text-align:center}.info-item.jsx-28bcee4bb7cc19b0 span.jsx-28bcee4bb7cc19b0{font-size:10px;color:var(--text-light)}.info-item.jsx-28bcee4bb7cc19b0 strong.jsx-28bcee4bb7cc19b0{font-size:12px;color:var(--accent-orange)}.modal-footer.jsx-28bcee4bb7cc19b0{padding:24px;border-top:1px solid#e5e7eb;text-align:center;background:#f9fafb}.proceed-btn.jsx-28bcee4bb7cc19b0{background:-webkit-linear-gradient(315deg,var(--color-accent)0%,#e8763a 100%);background:-moz-linear-gradient(315deg,var(--color-accent)0%,#e8763a 100%);background:-o-linear-gradient(315deg,var(--color-accent)0%,#e8763a 100%);background:linear-gradient(135deg,var(--color-accent)0%,#e8763a 100%);color:var(--white);border:none;padding:16px 32px;-webkit-border-radius:50px;-moz-border-radius:50px;border-radius:50px;font-size:16px;font-weight:600;cursor:pointer;-webkit-transition:all.3s cubic-bezier(.4,0,.2,1);-moz-transition:all.3s cubic-bezier(.4,0,.2,1);-o-transition:all.3s cubic-bezier(.4,0,.2,1);transition:all.3s cubic-bezier(.4,0,.2,1);margin-bottom:12px;-webkit-box-shadow:0 4px 12px rgba(223,104,43,.3);-moz-box-shadow:0 4px 12px rgba(223,104,43,.3);box-shadow:0 4px 12px rgba(223,104,43,.3);position:relative;overflow:hidden}.proceed-btn.jsx-28bcee4bb7cc19b0::before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:-webkit-linear-gradient(left,transparent,rgba(255,255,255,.2),transparent);background:-moz-linear-gradient(left,transparent,rgba(255,255,255,.2),transparent);background:-o-linear-gradient(left,transparent,rgba(255,255,255,.2),transparent);background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);-webkit-transition:left.6s ease;-moz-transition:left.6s ease;-o-transition:left.6s ease;transition:left.6s ease}.proceed-btn.jsx-28bcee4bb7cc19b0:hover:not(:disabled)::before{left:100%}.proceed-btn.jsx-28bcee4bb7cc19b0:hover:not(:disabled){-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-ms-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px);-webkit-box-shadow:0 8px 20px rgba(223,104,43,.4);-moz-box-shadow:0 8px 20px rgba(223,104,43,.4);box-shadow:0 8px 20px rgba(223,104,43,.4)}.proceed-btn.jsx-28bcee4bb7cc19b0:disabled{background:var(--border-gray);cursor:not-allowed}.warning.jsx-28bcee4bb7cc19b0{color:var(--accent-orange);font-size:11px;margin:0}@media(max-width:768px){.modal-container.jsx-28bcee4bb7cc19b0{margin:10px;max-height:95vh;max-width:-webkit-calc(100vw - 20px);max-width:-moz-calc(100vw - 20px);max-width:calc(100vw - 20px)}.modal-header.jsx-28bcee4bb7cc19b0{padding:24px 16px}.modal-header.jsx-28bcee4bb7cc19b0 h2.jsx-28bcee4bb7cc19b0{font-size:24px}.modal-content.jsx-28bcee4bb7cc19b0{padding:24px 16px}.lot-inputs.jsx-28bcee4bb7cc19b0,.custom-inputs.jsx-28bcee4bb7cc19b0{grid-template-columns:1fr}.houses-grid.jsx-28bcee4bb7cc19b0{grid-template-columns:repeat(2,1fr);gap:10px}.house-card.jsx-28bcee4bb7cc19b0{padding:12px;min-height:120px}.house-info.jsx-28bcee4bb7cc19b0 h4.jsx-28bcee4bb7cc19b0{min-height:40px}.series-selector.jsx-28bcee4bb7cc19b0{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.custom-info.jsx-28bcee4bb7cc19b0{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:12px}}'})]})}var x=i(5152);let b=i.n(x)()(()=>Promise.all([i.e(737),i.e(869)]).then(i.bind(i,8869)),{loadableGenerated:{webpack:()=>[8869]},ssr:!1,loading:()=>(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#000",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"18px",zIndex:1e3},children:"Загрузка 3D модели..."})});function c(e){let{initialData:t,onBack:i}=e,o=(0,r.useRef)(null),[n,l]=(0,r.useState)(1),[x,c]=(0,r.useState)({x:0,y:0}),[d,f]=(0,r.useState)(!1),[h,p]=(0,r.useState)({x:0,y:0}),[m,u]=(0,r.useState)("select"),[y,g]=(0,r.useState)(!1),[w,k]=(0,r.useState)(null),[j,v]=(0,r.useState)(null),[z,M]=(0,r.useState)(null),[N,S]=(0,r.useState)([]),[D,T]=(0,r.useState)([]),[C,I]=(0,r.useState)(new Set(["house"])),[W,F]=(0,r.useState)(!0),[A,E]=(0,r.useState)(null),[R,P]=(0,r.useState)(null),[Y,X]=(0,r.useState)(!1),[H,q]=(0,r.useState)(null),[B,L]=(0,r.useState)(null),[O,J]=(0,r.useState)(null),[_,K]=(0,r.useState)(!1),[Z,G]=(0,r.useState)({}),[U,V]=(0,r.useState)([]),[Q,$]=(0,r.useState)(-1),[ee,et]=(0,r.useState)([]),[ei,ea]=(0,r.useState)([]),[eo,es]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=o.current;if(e){let t=()=>{let t=e.parentElement.getBoundingClientRect();e.width=t.width,e.height=t.height,er()};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)}},[]),(0,r.useEffect)(()=>{let e=setTimeout(er,10);return()=>clearTimeout(e)},[n,x,t,w,N,D,ee,ei,Y,H,B,A,O,Z]),(0,r.useEffect)(()=>{let e=e=>{e.ctrlKey&&"z"===e.key?(e.preventDefault(),ef()):"Enter"===e.key?(e.preventDefault(),eh()):"Delete"===e.key&&w&&(e.preventDefault(),eJ(w.id))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[w,Q]),(0,r.useEffect)(()=>{if(t){let e=100+30*t.lotSize.width/2,i=100+30*t.lotSize.height/2,a=30*t.house.width,o=30*t.house.height,s={id:"house",type:"house",x:e-a/2,y:i-o/2,width:a,height:o,realWidth:t.house.width,realHeight:t.house.height};S([s]),I(new Set(["house"])),ed({elements:[s],walls:[]})}},[t]);let er=()=>{let e=o.current;if(!e||0===e.width||0===e.height)return;let t=e.getContext("2d");if(t.clearRect(0,0,e.width,e.height),t.save(),t.translate(x.x,x.y),en(t),el(t),ex(t),ec(t),e1(t),e8(t),Y&&H&&B){t.strokeStyle="#ff9800",t.lineWidth=3,t.setLineDash([5,5]),t.beginPath(),t.moveTo(H.x*n,H.y*n),t.lineTo(B.x*n,B.y*n),t.stroke(),t.setLineDash([]);let e=Math.sqrt(Math.pow(B.x-H.x,2)+Math.pow(B.y-H.y,2)),i=(H.x+B.x)/2*n,a=(H.y+B.y)/2*n;t.fillStyle="#ff9800",t.font="12px Arial",t.textAlign="center",t.fillText("".concat((e/30*1e3).toFixed(0),"мм"),i,a-10)}t.restore()},en=e=>{let t=o.current;if(!t)return;let i=20*n;for(;i<8;)i*=2;for(;i>80;)i/=2;if(i<5)return;let a=2*Math.max(t.width,t.height),s=-x.x-a,r=-x.y-a,l=-x.x+t.width+a,b=-x.y+t.height+a,c=Math.floor(s/i)*i,d=Math.floor(r/i)*i,f=Math.ceil(l/i)*i+i,h=Math.ceil(b/i)*i+i;e.strokeStyle="rgba(255, 255, 255, 0.08)",e.lineWidth=.5;for(let o=c;o<=f;o+=i){let i=o+x.x;e.beginPath(),e.moveTo(i,-a),e.lineTo(i,t.height+a),e.stroke()}for(let o=d;o<=h;o+=i){let i=o+x.y;e.beginPath(),e.moveTo(-a,i),e.lineTo(t.width+a,i),e.stroke()}if(i<=50){e.strokeStyle="rgba(255, 255, 255, 0.15)",e.lineWidth=1;let o=5*i,n=Math.floor(s/o)*o,c=Math.floor(r/o)*o,d=Math.ceil(l/o)*o+o,f=Math.ceil(b/o)*o+o;for(let i=n;i<=d;i+=o){let o=i+x.x;e.beginPath(),e.moveTo(o,-a),e.lineTo(o,t.height+a),e.stroke()}for(let i=c;i<=f;i+=o){let o=i+x.y;e.beginPath(),e.moveTo(-a,o),e.lineTo(t.width+a,o),e.stroke()}}},el=e=>{let i,a;let o=N.find(e=>"house"===e.type);if(!o)return;let s=30*t.lotSize.width*n,r=30*t.lotSize.height*n;W?(i=100*n,a=100*n):(i=o.x*n-50*n,a=o.y*n-50*n);let l=o.x*n,x=o.y*n,b=o.width*n,c=o.height*n,d=l<i||x<a||l+b>i+s||x+c>a+r;e.fillStyle=d?"rgba(255, 0, 0, 0.1)":"rgba(200, 200, 200, 0.05)",e.fillRect(i,a,s,r),e.strokeStyle=d?"#ff0000":W?"#2196f3":"#666",e.lineWidth=Math.max(2,3*n);let f=Math.max(8,15*n);if(e.setLineDash([f,.6*f]),e.strokeRect(i,a,s,r),e.setLineDash([]),"fix"===m&&(null==A?void 0:A.type)==="lot"&&(e.strokeStyle="#ffff00",e.lineWidth=3,e.strokeRect(i,a,s,r)),W&&n>=.4){let t=i+s-30,o=a+10;e.fillStyle="#ff0000",e.fillRect(t,o,20,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(t,o,20,20),e.fillStyle="#fff",e.font="12px Arial",e.textAlign="center",e.fillText("\uD83D\uDD12",t+10,o+14)}if((null==R?void 0:R.type)==="lot"&&n>=.4){let t=i+s-30,o=a+10;e.fillStyle="#00ff00",e.fillRect(t,o,20,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(t,o,20,20),e.fillStyle="#fff",e.font="12px Arial",e.textAlign="center",e.fillText("\uD83D\uDD13",t+10,o+14)}if(n>=.3){e.fillStyle=d?"#ff0000":"#666",e.font="14px Arial",e.textAlign="center";let o=(t.lotSize.width*t.lotSize.height/100).toFixed(2);e.fillText("".concat((1e3*t.lotSize.width).toFixed(0),"мм"),i+s/2,a-10*n),e.save(),e.translate(i-20*n,a+r/2),e.rotate(-Math.PI/2),e.fillText("".concat((1e3*t.lotSize.height).toFixed(0),"мм"),0,0),e.restore(),e.fillText("".concat(o," соток"),i+s/2,a+r+20*n)}d&&n>=.4&&(e.fillStyle="#ff0000",e.font="12px Arial",e.textAlign="center",e.fillText("Дом выходит за границы участка!",i+s/2,a+r+25*n))},ex=e=>{N.forEach(t=>{eb(e,t)})},eb=(e,t)=>{let i=(null==w?void 0:w.id)===t.id,a=C.has(t.id),o="select"===m&&(null==A?void 0:A.id)===t.id,s=t.width*n,r=t.height*n,l=t.x*n,x=t.y*n;if("house"===t.type?e.fillStyle=i?"#d4c5e8":o?"#f0e8ff":a?"#e8f4d4":"#eee8f4":e.fillStyle=i?"#c5d4e8":o?"#e8f0ff":a?"#d4e8c5":"#e8f4ee",e.fillRect(l,x,s,r),e.strokeStyle=i?"#df682b":o?"#9c27b0":a?"#4caf50":"#31323d",e.lineWidth=i?Math.max(2,3*n):o?Math.max(2,2*n):Math.max(1,2*n),e.strokeRect(l,x,s,r),"fix"===m&&(null==A?void 0:A.id)===t.id&&(e.strokeStyle="#ffff00",e.lineWidth=3,e.strokeRect(l-2,x-2,s+4,r+4)),a&&n>=.4){let t=l+s-25,i=x+5;e.fillStyle="#ff0000",e.fillRect(t,i,20,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(t,i,20,20),e.fillStyle="#fff",e.font="12px Arial",e.textAlign="center",e.fillText("\uD83D\uDD12",t+10,i+14)}if((null==R?void 0:R.id)===t.id&&n>=.4){let t=l+s-25,i=x+5;e.fillStyle="#00ff00",e.fillRect(t,i,20,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(t,i,20,20),e.fillStyle="#fff",e.font="12px Arial",e.textAlign="center",e.fillText("\uD83D\uDD13",t+10,i+14)}if(n>=.3&&"house"!==t.type){e.fillStyle="#31323d",e.font="10px Arial",e.textAlign="center";let i=l+s/2,a=x+r/2;t.realWidth&&t.realHeight&&e.fillText("".concat((1e3*t.realWidth).toFixed(0),"\xd7").concat((1e3*t.realHeight).toFixed(0),"мм"),i,a-5*n)}if(n>=.5){e.fillStyle="#df682b",e.font="8px Arial";let i=l+s/2,a=x+r/2;e.fillText("".concat((1e3*(t.realWidth||0)).toFixed(0),"мм"),i,x-8*n),e.save(),e.translate(l-12*n,a),e.rotate(-Math.PI/2),e.fillText("".concat((1e3*(t.realHeight||0)).toFixed(0),"мм"),0,0),e.restore()}i&&"select"===m&&!a&&eT(e,{...t,x:l,y:x,width:s,height:r})},ec=e=>{D.forEach(t=>{eD(e,t)}),eS(e)},ed=e=>{let t=U.slice(0,Q+1);t.push({elements:JSON.parse(JSON.stringify(e.elements||N)),walls:JSON.parse(JSON.stringify(e.walls||D)),doors:JSON.parse(JSON.stringify(e.doors||ee)),windows:JSON.parse(JSON.stringify(e.windows||ei))}),t.length>50?t.shift():$(e=>e+1),V(t)},ef=()=>{if(Q>0){let e=U[Q-1];S(e.elements),T(e.walls),et(e.doors||[]),ea(e.windows||[]),$(e=>e-1),k(null)}},eh=()=>{if(Y&&H&&B){let e=Math.sqrt(Math.pow(B.x-H.x,2)+Math.pow(B.y-H.y,2));if(e>15){let t=ek({id:Date.now(),x1:H.x,y1:H.y,x2:B.x,y2:B.y,length:e/30,thickness:.121,type:"interior"}),i=[...D,t];T(i),k(t),ed({elements:N,walls:i}),ed({elements:N,walls:i})}X(!1),q(null),L(null)}},ep=()=>{let e=N.find(e=>"house"===e.type);if(!e||0===D.length)return[];let t=[...D],i=[{id:"house-top",x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y,type:"boundary"},{id:"house-right",x1:e.x+e.width,y1:e.y,x2:e.x+e.width,y2:e.y+e.height,type:"boundary"},{id:"house-bottom",x1:e.x+e.width,y1:e.y+e.height,x2:e.x,y2:e.y+e.height,type:"boundary"},{id:"house-left",x1:e.x,y1:e.y+e.height,x2:e.x,y2:e.y,type:"boundary"}];t.push(...i);let a=new Set([e.x,e.x+e.width]),o=new Set([e.y,e.y+e.height]);D.forEach(t=>{t.x1>=e.x&&t.x1<=e.x+e.width&&a.add(t.x1),t.x2>=e.x&&t.x2<=e.x+e.width&&a.add(t.x2),t.y1>=e.y&&t.y1<=e.y+e.height&&o.add(t.y1),t.y2>=e.y&&t.y2<=e.y+e.height&&o.add(t.y2)}),em(t).forEach(t=>{t.x>=e.x&&t.x<=e.x+e.width&&a.add(t.x),t.y>=e.y&&t.y<=e.y+e.height&&o.add(t.y)});let s=Array.from(a).sort((e,t)=>e-t),r=Array.from(o).sort((e,t)=>e-t),n=[];for(let e=0;e<s.length-1;e++)for(let i=0;i<r.length-1;i++){let a=s[e],o=s[e+1],l=r[i],x=r[i+1];if(o-a>=15&&x-l>=15&&eu(a,l,o,x,t)){let e=ew(a,l,o,x,D);n.push({bounds:{minX:a,maxX:o,minY:l,maxY:x},walls:e,area:(o-a)*(x-l)/900,width:(o-a)/30,height:(x-l)/30})}}return n},em=e=>{let t=[];for(let i=0;i<e.length;i++)for(let a=i+1;a<e.length;a++){let o=ey(e[i].x1,e[i].y1,e[i].x2,e[i].y2,e[a].x1,e[a].y1,e[a].x2,e[a].y2);o&&t.push(o)}return t},eu=(e,t,i,a,o)=>[{x1:e,y1:t,x2:i,y2:t,name:"top"},{x1:i,y1:t,x2:i,y2:a,name:"right"},{x1:e,y1:a,x2:i,y2:a,name:"bottom"},{x1:e,y1:t,x2:e,y2:a,name:"left"}].every(e=>o.some(t=>eg(e.x1,e.y1,e.x2,e.y2,t.x1,t.y1,t.x2,t.y2,2))),ey=(e,t,i,a,o,s,r,n)=>{let l=(e-i)*(s-n)-(t-a)*(o-r);if(.001>Math.abs(l))return null;let x=((e-o)*(s-n)-(t-s)*(o-r))/l,b=-((e-i)*(t-s)-(t-a)*(e-o))/l;return x>=0&&x<=1&&b>=0&&b<=1?{x:e+x*(i-e),y:t+x*(a-t)}:null},eg=(e,t,i,a,o,s,r,n,l)=>Math.abs(t-a)<l&&Math.abs(s-n)<l&&Math.abs(t-s)<l?Math.max(Math.min(e,i),Math.min(o,r))<=Math.min(Math.max(e,i),Math.max(o,r))+l:!!(Math.abs(e-i)<l&&Math.abs(o-r)<l&&Math.abs(e-o)<l)&&Math.max(Math.min(t,a),Math.min(s,n))<=Math.min(Math.max(t,a),Math.max(s,n))+l,ew=(e,t,i,a,o)=>o.filter(o=>2>Math.abs(o.y1-t)&&2>Math.abs(o.y2-t)&&o.x1>=e-2&&o.x2<=i+2||2>Math.abs(o.y1-a)&&2>Math.abs(o.y2-a)&&o.x1>=e-2&&o.x2<=i+2||2>Math.abs(o.x1-e)&&2>Math.abs(o.x2-e)&&o.y1>=t-2&&o.y2<=a+2||2>Math.abs(o.x1-i)&&2>Math.abs(o.x2-i)&&o.y1>=t-2&&o.y2<=a+2),ek=e=>{let t=N.find(e=>"house"===e.type);return t&&(D.forEach(t=>{[{new:"start",existing:"start",newCoord:[e.x1,e.y1],existingCoord:[t.x1,t.y1]},{new:"start",existing:"end",newCoord:[e.x1,e.y1],existingCoord:[t.x2,t.y2]},{new:"end",existing:"start",newCoord:[e.x2,e.y2],existingCoord:[t.x1,t.y1]},{new:"end",existing:"end",newCoord:[e.x2,e.y2],existingCoord:[t.x2,t.y2]}].forEach(t=>{15>Math.sqrt(Math.pow(t.newCoord[0]-t.existingCoord[0],2)+Math.pow(t.newCoord[1]-t.existingCoord[1],2))&&("start"===t.new?(e.x1=t.existingCoord[0],e.y1=t.existingCoord[1]):(e.x2=t.existingCoord[0],e.y2=t.existingCoord[1]))})}),[{x:t.x,y:t.y,width:t.width,height:0,type:"top"},{x:t.x+t.width,y:t.y,width:0,height:t.height,type:"right"},{x:t.x,y:t.y+t.height,width:t.width,height:0,type:"bottom"},{x:t.x,y:t.y,width:0,height:t.height,type:"left"}].forEach(t=>{"top"===t.type||"bottom"===t.type?(15>Math.abs(e.y1-t.y)&&(e.y1=t.y),15>Math.abs(e.y2-t.y)&&(e.y2=t.y)):(15>Math.abs(e.x1-t.x)&&(e.x1=t.x),15>Math.abs(e.x2-t.x)&&(e.x2=t.x))})),e},ej=e=>{if(!e.bounds)return 0;let t=(e.bounds.maxX-e.bounds.minX)/30;return(e.bounds.maxY-e.bounds.minY)/30*t},ev=e=>e.bounds?{x:(e.bounds.minX+e.bounds.maxX)/2,y:(e.bounds.minY+e.bounds.maxY)/2}:{x:0,y:0},ez=(e,t)=>{let i=ep();for(let a=0;a<i.length;a++)if(eM(e,t,i[a]))return a;return null},eM=(e,t,i)=>!!i.bounds&&e>=i.bounds.minX&&e<=i.bounds.maxX&&t>=i.bounds.minY&&t<=i.bounds.maxY,eN=e=>{let t=prompt("Введите название комнаты:",Z[e]||"Комната ".concat(e+1));null!==t&&G(i=>({...i,[e]:t}))},eS=e=>{ep().forEach((t,i)=>{let a=ev(t),o=ej(t);if(o>.3&&n>=.3){e.fillStyle="#2196f3",e.font="12px Arial",e.textAlign="center";let s=Z[i]||"Комната ".concat(i+1);e.fillText(s,a.x*n,a.y*n-8),e.font="10px Arial",e.fillText("".concat(o.toFixed(1),"м\xb2"),a.x*n,a.y*n+8);let r=(t.bounds.maxX-t.bounds.minX)/30,l=(t.bounds.maxY-t.bounds.minY)/30;e.fillStyle="#666",e.font="9px Arial",e.fillText("".concat((1e3*r).toFixed(0),"\xd7").concat((1e3*l).toFixed(0),"мм"),a.x*n,a.y*n+20),t.walls&&t.walls.length>0&&(e.fillStyle="#ff6b35",e.font="8px Arial",e.fillText("Стен: ".concat(t.walls.length),a.x*n,a.y*n+32))}})},eD=(e,t)=>{let i=(null==w?void 0:w.id)===t.id,a=eo.some(e=>e.id===t.id),o="select"===m&&(null==O?void 0:O.id)===t.id,s=t.x1*n,r=t.y1*n,l=t.x2*n,x=t.y2*n,b=[...ee.filter(e=>e.wallId===t.id),...ei.filter(e=>e.wallId===t.id)];if(e.strokeStyle=i?"#df682b":a?"#2196f3":o?"#ff9800":"#8B4513",e.lineWidth=Math.max(3,30*t.thickness*n),0===b.length)e.beginPath(),e.moveTo(s,r),e.lineTo(l,x),e.stroke();else{let i=Math.sqrt(Math.pow(t.x2-t.x1,2)+Math.pow(t.y2-t.y1,2)),a=b.sort((e,t)=>e.position-t.position),o=0;if(a.forEach(a=>{let s=Math.max(0,a.position-a.width/(2*i)),r=Math.min(1,a.position+a.width/(2*i));if(o<s){let i=t.x1+(t.x2-t.x1)*o,a=t.y1+(t.y2-t.y1)*o,r=t.x1+(t.x2-t.x1)*s,l=t.y1+(t.y2-t.y1)*s;e.beginPath(),e.moveTo(i*n,a*n),e.lineTo(r*n,l*n),e.stroke()}o=r}),o<1){let i=t.x1+(t.x2-t.x1)*o,a=t.y1+(t.y2-t.y1)*o;e.beginPath(),e.moveTo(i*n,a*n),e.lineTo(l,x),e.stroke()}}if((i||a)&&"select"===m){e.fillStyle="#df682b",e.strokeStyle="#fff",e.lineWidth=1;let o=Math.max(6,8*n);e.beginPath(),e.arc(s,r,o,0,2*Math.PI),e.fill(),e.stroke(),e.beginPath(),e.arc(l,x,o,0,2*Math.PI),e.fill(),e.stroke();let b=(s+l)/2,c=(r+x)/2;if(e.fillStyle="#2196f3",e.beginPath(),e.arc(b,c,o,0,2*Math.PI),e.fill(),e.stroke(),i&&!a){let i=Math.min(r,x)-40,a=D.some(e=>e.id!==t.id&&(5>Math.abs(e.x1-t.x1)&&5>Math.abs(e.y1-t.y1)||5>Math.abs(e.x2-t.x2)&&5>Math.abs(e.y2-t.y2)||5>Math.abs(e.x1-t.x2)&&5>Math.abs(e.y1-t.y2)||5>Math.abs(e.x2-t.x1)&&5>Math.abs(e.y2-t.y1))),o=a?3:2,s=b-(24*o+(o-1)*5)/2;e.fillStyle="#ff4444",e.fillRect(s,i,24,24),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(s,i,24,24),e.fillStyle="#fff",e.font="16px Arial",e.textAlign="center",e.fillText("\uD83D\uDDD1️",s+12,i+16),e.fillStyle="#4CAF50",e.fillRect(s+24+5,i,24,24),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(s+24+5,i,24,24),e.fillStyle="#fff",e.fillText("\uD83D\uDD04",s+24+5+12,i+16),a&&(e.fillStyle="#ff9800",e.fillRect(s+58,i,24,24),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(s+58,i,24,24),e.fillStyle="#fff",e.fillText("\uD83D\uDD17",s+58+12,i+16))}}if(n>=.4){let a=(r+x)/2,o=Math.abs(l-s)>Math.abs(x-r);if(e.fillStyle="#8B4513",e.font="10px Arial",e.textAlign="center",o){let a=i?Math.min(r,x)-50:Math.min(r,x)-8;e.fillText("".concat((1e3*t.length).toFixed(0),"мм"),(s+l)/2,a)}else e.save(),e.translate(Math.min(s,l)-8,a),e.rotate(-Math.PI/2),e.fillText("".concat((1e3*t.length).toFixed(0),"мм"),0,0),e.restore()}},eT=(e,t)=>{let i=Math.max(8,12*n),a=[{id:"nw",x:t.x-i/2,y:t.y-i/2},{id:"ne",x:t.x+t.width-i/2,y:t.y-i/2},{id:"sw",x:t.x-i/2,y:t.y+t.height-i/2},{id:"se",x:t.x+t.width-i/2,y:t.y+t.height-i/2},{id:"n",x:t.x+t.width/2-i/2,y:t.y-i/2},{id:"s",x:t.x+t.width/2-i/2,y:t.y+t.height-i/2},{id:"w",x:t.x-i/2,y:t.y+t.height/2-i/2},{id:"e",x:t.x+t.width-i/2,y:t.y+t.height/2-i/2}];e.fillStyle="#df682b",e.strokeStyle="#ffffff",e.lineWidth=1,a.forEach(t=>{e.fillRect(t.x,t.y,i,i),e.strokeRect(t.x,t.y,i,i)})},eC=(e,i)=>{let a,o;let s=N.find(e=>"house"===e.type);if(!s)return!1;let r=30*t.lotSize.width,n=30*t.lotSize.height;return W?(a=100,o=100):(a=s.x-50,o=s.y-50),e>=a&&e<=a+r&&i>=o&&i<=o+n},eI=(e,t)=>{let i=N.find(e=>"house"===e.type);if(!i)return!1;let a=i.x,o=i.y,s=i.width,r=i.height;return e>=a&&e<=a+s&&t>=o&&t<=o+r},eW=(e,t)=>{for(let i=D.length-1;i>=0;i--){let a=D[i];if(1.5>eF(e,t,a.x1,a.y1,a.x2,a.y2))return a}return null},eF=(e,t,i,a,o,s)=>{let r=e-i,n=t-a,l=o-i,x=s-a,b=l*l+x*x;if(0===b)return Math.sqrt(r*r+n*n);let c=Math.max(0,Math.min(1,(r*l+n*x)/b)),d=e-(i+c*l),f=t-(a+c*x);return Math.sqrt(d*d+f*f)},eA=(e,t)=>{for(let i=N.length-1;i>=0;i--){let a=N[i];if(e>=a.x&&e<=a.x+a.width&&t>=a.y&&t<=a.y+a.height)return a}return null},eE=(e,t,i)=>{let a=Math.max(8,12*n)+4,o=i.x*n,s=i.y*n,r=i.width*n,l=i.height*n;for(let i of[{id:"nw",x:o,y:s},{id:"ne",x:o+r,y:s},{id:"sw",x:o,y:s+l},{id:"se",x:o+r,y:s+l},{id:"n",x:o+r/2,y:s},{id:"s",x:o+r/2,y:s+l},{id:"w",x:o,y:s+l/2},{id:"e",x:o+r,y:s+l/2}]){let o=i.x+x.x,s=i.y+x.y;if(Math.abs(e-o)<=a&&Math.abs(t-s)<=a)return i.id}return null},eR=(e,t,i)=>{if(!i||void 0===i.x1)return null;let a=Math.max(6,8*n)+4,o=i.x1*n+x.x,s=i.y1*n+x.y,r=i.x2*n+x.x,l=i.y2*n+x.y;return Math.abs(e-o)<=a&&Math.abs(t-s)<=a?"start":Math.abs(e-r)<=a&&Math.abs(t-l)<=a?"end":null},eP=(e,t)=>{let i=D.find(e=>e.id===z.elementId);if(!i)return;let a=N.find(e=>"house"===e.type);if(!a)return;let o=Math.max(a.x,Math.min(a.x+a.width,e)),s=Math.max(a.y,Math.min(a.y+a.height,t)),r={...i};"start"===z.handle?(r.x1=o,r.y1=s):"end"===z.handle&&(r.x2=o,r.y2=s);let n=Math.sqrt(Math.pow(r.x2-r.x1,2)+Math.pow(r.y2-r.y1,2))/30;r.length=n,T(e=>e.map(e=>e.id===i.id?r:e)),k(r)},eY=(e,t)=>{if(z.isWall){eP(e,t);return}let i=N.find(e=>e.id===z.elementId);if(!i)return;let a=i.x,o=i.y,s=i.width,r=i.height;switch(z.handle){case"nw":s=i.x+i.width-e,r=i.y+i.height-t,a=e,o=t;break;case"ne":s=e-i.x,r=i.y+i.height-t,o=t;break;case"sw":s=i.x+i.width-e,r=t-i.y,a=e;break;case"se":s=e-i.x,r=t-i.y;break;case"n":r=i.y+i.height-t,o=t;break;case"s":r=t-i.y;break;case"w":s=i.x+i.width-e,a=e;break;case"e":s=e-i.x}s<30&&(z.handle.includes("w")&&(a=i.x+i.width-30),s=30),r<30&&(z.handle.includes("n")&&(o=i.y+i.height-30),r=30);let n=s/30,l=r/30;S(e=>e.map(e=>e.id===z.elementId?{...e,x:a,y:o,width:s,height:r,realWidth:Math.round(10*n)/10,realHeight:Math.round(10*l)/10}:e))},eX=(e,t)=>{let i=o.current;if(!i)return;let a="default";if("select"===m){if(a="grab",w){let i=eE(e,t,w),o=eR(e,t,w);i?a=({nw:"nw-resize",ne:"ne-resize",sw:"sw-resize",se:"se-resize",n:"n-resize",s:"s-resize",w:"w-resize",e:"e-resize"})[i]||"pointer":o&&(a="move")}d&&(a="grabbing")}else"wall"===m&&(a="crosshair");i.style.cursor=a},eH=e=>{let t=N.find(t=>t.id===e)||D.find(t=>t.id===e);if(t){if("house"===t.type){let t=N.map(t=>t.id===e?{...t,width:t.height,height:t.width,realWidth:t.realHeight,realHeight:t.realWidth}:t);S(t),ed({elements:t,walls:D})}else if(void 0!==t.x1){let i,a,o,s;let r=(t.x1+t.x2)/2,n=(t.y1+t.y2)/2,l=30*t.length;Math.abs(t.x2-t.x1)>Math.abs(t.y2-t.y1)?(i=r,a=n-l/2,o=r,s=n+l/2):(i=r-l/2,a=n,o=r+l/2,s=n);let x=D.map(t=>t.id===e?{...t,x1:i,y1:a,x2:o,y2:s}:t);T(x),ed({elements:N,walls:x})}}},eq=e=>{if(e.length<2)return!1;let t=e[0],i=Math.abs(t.x2-t.x1)>Math.abs(t.y2-t.y1);for(let t of e)if(Math.abs(t.x2-t.x1)>Math.abs(t.y2-t.y1)!==i)return!1;if(i){let i=t.y1;for(let t of e)if(Math.abs(t.y1-i)>5||Math.abs(t.y2-i)>5)return!1}else{let i=t.x1;for(let t of e)if(Math.abs(t.x1-i)>5||Math.abs(t.x2-i)>5)return!1}return!0},eB=e=>{let t=D.find(t=>t.id===e);if(!t)return;let i=[];if(D.forEach(a=>{if(a.id!==e&&Math.abs(t.x2-t.x1)>Math.abs(t.y2-t.y1)==Math.abs(a.x2-a.x1)>Math.abs(a.y2-a.y1)){let e=Math.sqrt(Math.pow(t.x2-a.x1,2)+Math.pow(t.y2-a.y1,2)),o=Math.sqrt(Math.pow(t.x1-a.x2,2)+Math.pow(t.y1-a.y2,2));(e<20||o<20)&&i.push(a)}}),i.length>0){let a=[t,...i],o=Math.min(...a.map(e=>Math.min(e.x1,e.x2))),s=Math.max(...a.map(e=>Math.max(e.x1,e.x2))),r=Math.min(...a.map(e=>Math.min(e.y1,e.y2))),n=Math.max(...a.map(e=>Math.max(e.y1,e.y2))),l=Math.abs(t.x2-t.x1)>Math.abs(t.y2-t.y1),x={...t,x1:l?o:t.x1,y1:l?t.y1:r,x2:l?s:t.x2,y2:l?t.y2:n,length:l?(s-o)/30:(n-r)/30},b=D.filter(t=>t.id!==e&&!i.some(e=>e.id===t.id));b.push(x),T(b),k(x),ed({elements:N,walls:b})}},eL=(e,t,i)=>{let a,o;let s=D.find(e=>e.id===i.wallId)||e4(i.wallId);if(!s)return!1;let r=Math.abs(s.x2-s.x1)>Math.abs(s.y2-s.y1),l=s.x1+(s.x2-s.x1)*i.position,b=s.y1+(s.y2-s.y1)*i.position;return r?(a=l*n+x.x-12,o=(b-i.width/2-("door"===i.type?25:35))*n+x.y):(a=(l-i.width/2-30)*n+x.x,o=b*n+x.y-10),e>=a&&e<=a+24&&t>=o&&t<=o+20&&("door"===i.type?et(e=>e.filter(e=>e.id!==i.id)):ea(e=>e.filter(e=>e.id!==i.id)),k(null),!0)},eO=(e,t,i)=>{if(!i||"select"!==m)return!1;if(void 0!==i.x1){let a=i.x1*n+x.x,o=i.y1*n+x.y,s=i.x2*n+x.x,r=Math.min(o,i.y2*n+x.y)-40,l=D.some(e=>e.id!==i.id&&(5>Math.abs(e.x1-i.x1)&&5>Math.abs(e.y1-i.y1)||5>Math.abs(e.x2-i.x2)&&5>Math.abs(e.y2-i.y2)||5>Math.abs(e.x1-i.x2)&&5>Math.abs(e.y1-i.y2)||5>Math.abs(e.x2-i.x1)&&5>Math.abs(e.y2-i.y1))),b=l?3:2,c=(a+s)/2-(24*b+(b-1)*5)/2;if(e>=c&&e<=c+24&&t>=r&&t<=r+24)return eJ(i.id),!0;if(e>=c+24+5&&e<=c+48+5&&t>=r&&t<=r+24)return eH(i.id),!0;if(l&&e>=c+58&&e<=c+72+10&&t>=r&&t<=r+24)return eB(i.id),!0}return!1},eJ=e=>{let t=N.filter(t=>t.id!==e),i=D.filter(t=>t.id!==e),a=ee.filter(t=>t.id!==e),o=ei.filter(t=>t.id!==e);S(t),T(i),et(a),ea(o),k(null),ed({elements:t,walls:i,doors:a,windows:o})},e_=(e,t)=>{if(w&&t&&!(t<=0)&&"house"===w.type){let i="width"===e?t:w.realWidth,a="height"===e?t:w.realHeight,o=N.map(e=>e.id===w.id?{...e,width:30*i,height:30*a,realWidth:i,realHeight:a}:e);S(o),ed({elements:o,walls:D}),k(i=>({...i,width:("width"===e?t:i.realWidth)*30,height:("height"===e?t:i.realHeight)*30,realWidth:"width"===e?t:i.realWidth,realHeight:"height"===e?t:i.realHeight}))}},eK=e=>{let t,i,a,o;if(!w||void 0===w.x1||!e||e<=0)return;let s=N.find(e=>"house"===e.type);if(!s)return;let r=(w.x1+w.x2)/2,n=(w.y1+w.y2)/2,l=Math.abs(w.x2-w.x1)>Math.abs(w.y2-w.y1),x=30*e;l?(t=r-x/2,i=w.y1,a=r+x/2,o=w.y2):(t=w.x1,i=n-x/2,a=w.x2,o=n+x/2),t=Math.max(s.x,Math.min(s.x+s.width,t)),i=Math.max(s.y,Math.min(s.y+s.height,i)),a=Math.max(s.x,Math.min(s.x+s.width,a)),o=Math.max(s.y,Math.min(s.y+s.height,o));let b=Math.sqrt(Math.pow(a-t,2)+Math.pow(o-i,2))/30,c=D.map(e=>e.id===w.id?{...e,x1:t,y1:i,x2:a,y2:o,length:b}:e);T(c),ed({elements:N,walls:c}),k(e=>({...e,x1:t,y1:i,x2:a,y2:o,length:b}))},eZ=e=>{if(!w||!e||e<=0)return;let t=30*e;"door"===w.type?(et(ee.map(i=>i.id===w.id?{...i,width:t,realWidth:e}:i)),k(i=>({...i,width:t,realWidth:e}))):"window"===w.type&&(ea(ei.map(i=>i.id===w.id?{...i,width:t,realWidth:e}:i)),k(i=>({...i,width:t,realWidth:e})))},eG=()=>{if(Y&&H&&B){let e=Math.sqrt(Math.pow(B.x-H.x,2)+Math.pow(B.y-H.y,2));if(e>15){let t=ek({id:Date.now(),x1:H.x,y1:H.y,x2:B.x,y2:B.y,length:e/30,thickness:.121,type:"interior"}),i=[...D,t];T(i),k(t),ed({elements:N,walls:i})}}X(!1),q(null),L(null),f(!1),v(null),M(null)},[eU,eV]=(0,r.useState)(null),[eQ,e$]=(0,r.useState)(null),e0=(e,t)=>{let i=N.find(e=>"house"===e.type);if(!i)return null;let a=i.x,o=i.y,s=i.width,r=i.height;return 10>Math.abs(t-o)&&e>=a&&e<=a+s?{id:"house-top",x1:a,y1:o,x2:a+s,y2:o,type:"boundary"}:10>Math.abs(t-(o+r))&&e>=a&&e<=a+s?{id:"house-bottom",x1:a,y1:o+r,x2:a+s,y2:o+r,type:"boundary"}:10>Math.abs(e-a)&&t>=o&&t<=o+r?{id:"house-left",x1:a,y1:o,x2:a,y2:o+r,type:"boundary"}:10>Math.abs(e-(a+s))&&t>=o&&t<=o+r?{id:"house-right",x1:a+s,y1:o,x2:a+s,y2:o+r,type:"boundary"}:null},e2=(e,t,i,a)=>{try{let o;let s=Math.abs(e.x2-e.x1)>Math.abs(e.y2-e.y1),r=Math.sqrt(Math.pow(e.x2-e.x1,2)+Math.pow(e.y2-e.y1,2));o=s?(t-Math.min(e.x1,e.x2))/r:(i-Math.min(e.y1,e.y2))/r;let n="door"===a?24:45,l=[...ee.filter(t=>t.wallId===e.id),...ei.filter(t=>t.wallId===e.id)],x=n/(2*r),b=10/r;for(let e of l){let t=e.width/(2*r),i=Math.abs(o-e.position),s=x+t+b;if(i<s){alert("Нельзя разместить ".concat("door"===a?"дверь":"окно"," здесь - слишком близко к другому элементу"));return}}if(o-x<0||o+x>1){alert("Нельзя разместить ".concat("door"===a?"дверь":"окно"," здесь - выходит за границы стены"));return}let c={id:Date.now(),wallId:e.id,position:o,width:n,realWidth:"door"===a?.8:1.5,type:a};"door"===a?(et(e=>[...e,c]),ed({elements:N,walls:D,doors:[...ee,c],windows:ei})):(ea(e=>[...e,c]),ed({elements:N,walls:D,doors:ee,windows:[...ei,c]}))}catch(e){console.error("Ошибка при добавлении двери/окна:",e)}},e1=e=>{let t={};ee.forEach(e=>{t[e.wallId]||(t[e.wallId]=[]),t[e.wallId].push(e)}),Object.entries(t).forEach(t=>{let[i,a]=t,o=D.find(e=>e.id===parseInt(i))||e4(i);if(!o)return;let s=Math.abs(o.x2-o.x1)>Math.abs(o.y2-o.y1);o.x2,o.x1,o.y2,o.y1,a.sort((e,t)=>e.position-t.position).forEach(t=>{let i=o.x1+(o.x2-o.x1)*t.position,a=o.y1+(o.y2-o.y1)*t.position;if(e.strokeStyle="#ffffff",e.lineWidth=Math.max(6,8*n),s){if(e.beginPath(),e.moveTo((i-t.width/2)*n,a*n),e.lineTo((i+t.width/2)*n,a*n),e.stroke(),e.fillStyle=(null==w?void 0:w.id)===t.id?"#df682b":"#8B4513",e.fillRect((i-t.width/2+2)*n,(a-3)*n,(t.width-4)*n,6*n),e.strokeStyle=(null==w?void 0:w.id)===t.id?"#df682b":"#666",e.lineWidth=(null==w?void 0:w.id)===t.id?2:1,e.setLineDash([3,3]),e.beginPath(),e.arc(i*n,a*n,t.width/2*n,0,Math.PI),e.stroke(),e.setLineDash([]),e.fillStyle="#333",e.beginPath(),e.arc((i+t.width/3)*n,a*n,2,0,2*Math.PI),e.fill(),n>=.5&&(e.fillStyle="#8B4513",e.font="8px Arial",e.textAlign="center",e.fillText("".concat((1e3*t.realWidth).toFixed(0),"мм"),i*n,(a-t.width/2-8)*n)),(null==w?void 0:w.id)===t.id){let o=i*n-12,s=(a-t.width/2-25)*n;e.fillStyle="#ff4444",e.fillRect(o,s,24,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(o,s,24,20),e.fillStyle="#fff",e.font="14px Arial",e.textAlign="center",e.fillText("\uD83D\uDDD1️",o+12,s+14)}}else if(e.beginPath(),e.moveTo(i*n,(a-t.width/2)*n),e.lineTo(i*n,(a+t.width/2)*n),e.stroke(),e.fillStyle=(null==w?void 0:w.id)===t.id?"#df682b":"#8B4513",e.fillRect((i-3)*n,(a-t.width/2+2)*n,6*n,(t.width-4)*n),e.strokeStyle=(null==w?void 0:w.id)===t.id?"#df682b":"#666",e.lineWidth=(null==w?void 0:w.id)===t.id?2:1,e.setLineDash([3,3]),e.beginPath(),e.arc(i*n,a*n,t.width/2*n,-Math.PI/2,Math.PI/2),e.stroke(),e.setLineDash([]),e.fillStyle="#333",e.beginPath(),e.arc(i*n,(a+t.width/3)*n,2,0,2*Math.PI),e.fill(),n>=.5&&(e.fillStyle="#8B4513",e.font="8px Arial",e.textAlign="center",e.save(),e.translate((i-t.width/2-12)*n,a*n),e.rotate(-Math.PI/2),e.fillText("".concat((1e3*t.realWidth).toFixed(0),"мм"),0,0),e.restore()),(null==w?void 0:w.id)===t.id){let o=(i-t.width/2-30)*n,s=a*n-10;e.fillStyle="#ff4444",e.fillRect(o,s,24,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(o,s,24,20),e.fillStyle="#fff",e.font="14px Arial",e.textAlign="center",e.fillText("\uD83D\uDDD1️",o+12,s+14)}})})},e8=e=>{let t={};ei.forEach(e=>{t[e.wallId]||(t[e.wallId]=[]),t[e.wallId].push(e)}),Object.entries(t).forEach(t=>{let[i,a]=t,o=D.find(e=>e.id===parseInt(i))||e4(i);if(!o)return;let s=Math.abs(o.x2-o.x1)>Math.abs(o.y2-o.y1);o.x2,o.x1,o.y2,o.y1,a.sort((e,t)=>e.position-t.position).forEach(t=>{let i=o.x1+(o.x2-o.x1)*t.position,a=o.y1+(o.y2-o.y1)*t.position;if(e.strokeStyle="#ffffff",e.lineWidth=Math.max(6,8*n),s){if(e.beginPath(),e.moveTo((i-t.width/2)*n,a*n),e.lineTo((i+t.width/2)*n,a*n),e.stroke(),e.strokeStyle=(null==w?void 0:w.id)===t.id?"#df682b":"#4169E1",e.lineWidth=(null==w?void 0:w.id)===t.id?3:2,e.strokeRect((i-t.width/2)*n,(a-6)*n,t.width*n,12*n),e.strokeStyle=(null==w?void 0:w.id)===t.id?"#df682b":"#4169E1",e.lineWidth=1,e.beginPath(),e.moveTo((i-t.width/2)*n,a*n),e.lineTo((i+t.width/2)*n,a*n),e.stroke(),e.beginPath(),e.moveTo(i*n,(a-6)*n),e.lineTo(i*n,(a+6)*n),e.stroke(),n>=.5&&(e.fillStyle="#4169E1",e.font="8px Arial",e.textAlign="center",e.fillText("".concat((1e3*t.realWidth).toFixed(0),"мм"),i*n,(a-18)*n)),(null==w?void 0:w.id)===t.id){let o=i*n-12,s=(a-t.width/2-35)*n;e.fillStyle="#ff4444",e.fillRect(o,s,24,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(o,s,24,20),e.fillStyle="#fff",e.font="14px Arial",e.textAlign="center",e.fillText("\uD83D\uDDD1️",o+12,s+14)}}else if(e.beginPath(),e.moveTo(i*n,(a-t.width/2)*n),e.lineTo(i*n,(a+t.width/2)*n),e.stroke(),e.strokeStyle=(null==w?void 0:w.id)===t.id?"#df682b":"#4169E1",e.lineWidth=(null==w?void 0:w.id)===t.id?3:2,e.strokeRect((i-6)*n,(a-t.width/2)*n,12*n,t.width*n),e.strokeStyle=(null==w?void 0:w.id)===t.id?"#df682b":"#4169E1",e.lineWidth=1,e.beginPath(),e.moveTo((i-6)*n,a*n),e.lineTo((i+6)*n,a*n),e.stroke(),e.beginPath(),e.moveTo(i*n,(a-t.width/2)*n),e.lineTo(i*n,(a+t.width/2)*n),e.stroke(),n>=.5&&(e.fillStyle="#4169E1",e.font="8px Arial",e.textAlign="center",e.save(),e.translate((i-18)*n,a*n),e.rotate(-Math.PI/2),e.fillText("".concat((1e3*t.realWidth).toFixed(0),"мм"),0,0),e.restore()),(null==w?void 0:w.id)===t.id){let o=(i-t.width/2-30)*n,s=a*n-10;e.fillStyle="#ff4444",e.fillRect(o,s,24,20),e.strokeStyle="#fff",e.lineWidth=1,e.strokeRect(o,s,24,20),e.fillStyle="#fff",e.font="14px Arial",e.textAlign="center",e.fillText("\uD83D\uDDD1️",o+12,s+14)}})})},e4=e=>{let t=N.find(e=>"house"===e.type);if(!t)return null;let i={"house-top":{x1:t.x,y1:t.y,x2:t.x+t.width,y2:t.y},"house-bottom":{x1:t.x,y1:t.y+t.height,x2:t.x+t.width,y2:t.y+t.height},"house-left":{x1:t.x,y1:t.y,x2:t.x,y2:t.y+t.height},"house-right":{x1:t.x+t.width,y1:t.y,x2:t.x+t.width,y2:t.y+t.height}};return i[e]?{id:e,...i[e],type:"boundary"}:null},e3=(e,t)=>{for(let i of ee){let a=D.find(e=>e.id===i.wallId)||e4(i.wallId);if(!a)continue;let o=a.x1+(a.x2-a.x1)*i.position,s=a.y1+(a.y2-a.y1)*i.position;if(Math.abs(e-o)<i.width/2&&Math.abs(t-s)<i.width/2)return i}return null},e9=(e,t)=>{for(let i of ei){let a=D.find(e=>e.id===i.wallId)||e4(i.wallId);if(!a)continue;let o=a.x1+(a.x2-a.x1)*i.position,s=a.y1+(a.y2-a.y1)*i.position;if(Math.abs(e-o)<i.width/2&&Math.abs(t-s)<i.width/2)return i}return null},e6=(e,t,i,a)=>{let o;let s=D.find(t=>t.id===e.wallId)||e4(e.wallId);if(!s)return;let r=Math.abs(s.x2-s.x1)>Math.abs(s.y2-s.y1),n=Math.sqrt(Math.pow(s.x2-s.x1,2)+Math.pow(s.y2-s.y1,2));o=r?(t-Math.min(s.x1,s.x2))/n:(i-Math.min(s.y1,s.y2))/n;let l=[...ee.filter(t=>t.wallId===e.wallId&&t.id!==e.id),...ei.filter(t=>t.wallId===e.wallId&&t.id!==e.id)],x=e.width/(2*n),b=10/n;for(let e of l){let t=e.width/(2*n);if(Math.abs(o-e.position)<x+t+b)return}o=Math.max(x,Math.min(1-x,o)),"door"===a?et(t=>t.map(t=>t.id===e.id?{...t,position:o}:t)):ea(t=>t.map(t=>t.id===e.id?{...t,position:o}:t))};return(0,a.jsxs)(a.Fragment,{children:[y&&(0,a.jsx)(b,{elements:N,walls:D,doors:ee,windows:ei,initialData:t,onClose:()=>g(!1)}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 constructor-interface fade-in",children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 constructor-header",children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 header-left",children:[(0,a.jsx)("button",{onClick:i,className:"jsx-964e21069faa8b83 back-btn",children:"⚙️ Настройки"}),(0,a.jsx)("h1",{className:"jsx-964e21069faa8b83",children:"Конструктор модульных домов"})]}),(0,a.jsx)("div",{className:"jsx-964e21069faa8b83 header-right",children:(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 project-info",children:[(0,a.jsxs)("span",{className:"jsx-964e21069faa8b83",children:["Дом: ",(1e3*t.house.width).toFixed(0),"\xd7",(1e3*t.house.height).toFixed(0),"мм"]}),(0,a.jsxs)("span",{className:"jsx-964e21069faa8b83",children:["Участок: ",(1e3*t.lotSize.width).toFixed(0),"\xd7",(1e3*t.lotSize.height).toFixed(0),"мм (",(t.lotSize.width*t.lotSize.height/100).toFixed(2)," соток)"]})]})})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 constructor-body",children:[(0,a.jsx)("div",{className:"jsx-964e21069faa8b83 workspace",children:(0,a.jsx)("canvas",{ref:o,onMouseDown:e=>{let t=o.current;if(!t)return;let i=t.getBoundingClientRect(),a=e.clientX-i.left,s=e.clientY-i.top,r=(a-x.x)/n,l=(s-x.y)/n;if("fix"===m){let e=eA(r,l),t=eW(r,l);if(e){C.has(e.id)?(I(t=>{let i=new Set(t);return i.delete(e.id),i}),P({id:e.id}),setTimeout(()=>P(null),2e3)):I(t=>new Set(t).add(e.id)),er();return}if(t){C.has(t.id)?(I(e=>{let i=new Set(e);return i.delete(t.id),i}),P({id:t.id}),setTimeout(()=>P(null),2e3)):I(e=>new Set(e).add(t.id)),er();return}if(eC(r,l)){W?(F(!1),P({type:"lot"}),setTimeout(()=>P(null),2e3)):F(!0),er();return}}else if("wall"===m){eI(r,l)&&(X(!0),q({x:r,y:l}),L({x:r,y:l}));return}else if("door"===m||"window"===m){let e=eW(r,l)||e0(r,l);e&&e2(e,r,l,m);return}else if("select"===m){if(w&&!C.has(w.id)){let e=eE(a,s,w);if(e){M({elementId:w.id,handle:e});return}let t=eR(a,s,w);if(t){M({elementId:w.id,handle:t,isWall:!0});return}}if(w&&eO(a,s,w)||w&&("door"===w.type||"window"===w.type)&&eL(a,s,w))return;let t=e3(r,l),i=e9(r,l),o=eW(r,l),n=eA(r,l),x=ez(r,l);if(t){k(t),v({element:t,startX:r,startY:l,type:"door"});return}if(i){k(i),v({element:i,startX:r,startY:l,type:"window"});return}if(o){e.ctrlKey?(es(e=>e.some(e=>e.id===o.id)?e.filter(e=>e.id!==o.id):[...e,o]),k(null)):(es([]),k(o),C.has(o.id)||v({element:o,startX:r,startY:l}));return}if(n){k(n),C.has(n.id)||v({element:n,startX:r-n.x,startY:l-n.y});return}else if(null!==x)return;e.ctrlKey||(k(null),es([]))}f(!0),p({x:e.clientX-x.x,y:e.clientY-x.y})},onMouseMove:e=>{let i=o.current;if(!i)return;let a=i.getBoundingClientRect(),s=e.clientX-a.left,r=e.clientY-a.top,l=(s-x.x)/n,b=(r-x.y)/n;if("fix"===m){i.style.cursor="pointer";let e=eA(l,b)||eW(l,b);e?E(e):eC(l,b)?E({type:"lot"}):E(null)}else if("select"===m){let e=eW(l,b),t=eA(l,b);e?(J(e),E(null),i.style.cursor="pointer"):t?(E(t),J(null),i.style.cursor="pointer"):(E(null),J(null),i.style.cursor="grab")}else E(null),J(null),i.style.cursor="wall"===m?"crosshair":"default";if(Y&&H){let e,t;Math.abs(l-H.x)>Math.abs(b-H.y)?(e=l,t=H.y):(e=H.x,t=b);let i=N.find(e=>"house"===e.type);i&&(e=Math.max(i.x,Math.min(i.x+i.width,e)),t=Math.max(i.y,Math.min(i.y+i.height,t))),L({x:e,y:t})}if(z&&!C.has(z.elementId)){eY(l,b);return}if(j&&"select"===m){if("door"===j.type)e6(j.element,l,b,"door");else if("window"===j.type)e6(j.element,l,b,"window");else if(!C.has(j.element.id)){if("house"===j.element.type){let e=l-j.startX,i=b-j.startY;if(W){let a=100/n,o=100/n,s=30*t.lotSize.width,r=30*t.lotSize.height;e=Math.max(a,Math.min(a+s-j.element.width,e)),i=Math.max(o,Math.min(o+r-j.element.height,i))}S(t=>t.map(t=>t.id===j.element.id?{...t,x:e,y:i}:t))}else if(void 0!==j.element.x1){let e=l-j.startX,t=b-j.startY;T(i=>i.map(i=>i.id===j.element.id?{...i,x1:i.x1+e,y1:i.y1+t,x2:i.x2+e,y2:i.y2+t}:i)),v({...j,startX:l,startY:b})}}return}d&&c({x:e.clientX-h.x,y:e.clientY-h.y}),eX(s,r)},onMouseUp:eG,onMouseLeave:eG,onDoubleClick:e=>{let t=o.current;if(!t)return;let i=t.getBoundingClientRect(),a=e.clientX-i.left,s=e.clientY-i.top,r=ez((a-x.x)/n,(s-x.y)/n);null!==r&&eN(r)},onWheel:e=>{e.preventDefault();let t=e.deltaY>0?.9:1.1;l(e=>Math.max(.3,Math.min(5,e*t)))},onTouchStart:e=>{if(e.preventDefault(),1===e.touches.length){let t=e.touches[0],i=o.current.getBoundingClientRect(),a=t.clientX-i.left,s=t.clientY-i.top,r=a-x.x,n=s-x.y;e$({x:t.clientX,y:t.clientY});let l=eA(r,n);l?(k(l),v({element:l,startX:r-l.x,startY:n-l.y})):(k(null),f(!0),p({x:t.clientX-x.x,y:t.clientY-x.y}))}else 2===e.touches.length&&(eV(Math.sqrt(Math.pow(e.touches[0].clientX-e.touches[1].clientX,2)+Math.pow(e.touches[0].clientY-e.touches[1].clientY,2))),f(!1),v(null))},onTouchMove:e=>{if(e.preventDefault(),1===e.touches.length){let t=e.touches[0],i=o.current.getBoundingClientRect(),a=t.clientX-i.left,s=t.clientY-i.top,r=a-x.x,n=s-x.y;if(j){let e=r-j.startX,t=n-j.startY;S(i=>i.map(i=>i.id===j.element.id?{...i,x:e,y:t}:i))}else d&&eQ&&c({x:t.clientX-h.x,y:t.clientY-h.y})}else if(2===e.touches.length&&eU){let t=Math.sqrt(Math.pow(e.touches[0].clientX-e.touches[1].clientX,2)+Math.pow(e.touches[0].clientY-e.touches[1].clientY,2)),i=t/eU;l(e=>Math.max(.3,Math.min(5,e*i))),eV(t)}},onTouchEnd:()=>{f(!1),v(null),M(null),eV(null),e$(null)},className:"jsx-964e21069faa8b83"})}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 "+"control-panel ".concat(_?"collapsed":""),children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-header",children:[(0,a.jsx)("button",{title:"Отправить проект на расчет",onClick:()=>alert("Проект отправлен на расчет!"),className:"jsx-964e21069faa8b83 calculate-btn",children:"\uD83D\uDCCA Рассчитать проект"}),(0,a.jsx)("button",{title:"Свернуть",onClick:()=>K(!_),className:"jsx-964e21069faa8b83 collapse-btn",children:_?"◀":"▶"})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-section",children:[(0,a.jsx)("h3",{className:"jsx-964e21069faa8b83",children:"Режим просмотра"}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 view-toggle",children:[(0,a.jsx)("button",{onClick:()=>g(!1),className:"jsx-964e21069faa8b83 "+((y?"":"active")||""),children:"2D План"}),(0,a.jsx)("button",{onClick:()=>g(!0),className:"jsx-964e21069faa8b83 "+((y?"active":"")||""),children:"3D Вид"})]})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-section",children:[(0,a.jsx)("h3",{className:"jsx-964e21069faa8b83",children:"Инструменты"}),(0,a.jsx)("div",{className:"jsx-964e21069faa8b83 tools-grid",children:[{id:"select",name:"Выбор",icon:"\uD83D\uDC46"},{id:"wall",name:"Стена",icon:"\uD83E\uDDF1"},{id:"door",name:"Дверь",icon:"\uD83D\uDEAA"},{id:"window",name:"Окно",icon:"\uD83E\uDE9F"},{id:"fix",name:"Фиксация",icon:"\uD83D\uDD12"},{id:"rotate",name:"Поворот",icon:"\uD83D\uDD04"}].map(e=>(0,a.jsxs)("button",{onClick:()=>{"rotate"===e.id&&w?eH(w.id):u(e.id)},className:"jsx-964e21069faa8b83 "+"tool-btn ".concat(m===e.id?"active":""),children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83 tool-icon",children:e.icon}),(0,a.jsx)("span",{className:"jsx-964e21069faa8b83 tool-name",children:e.name})]},e.id))}),eo.length>1&&(0,a.jsx)("div",{className:"jsx-964e21069faa8b83 merge-section",children:(0,a.jsxs)("button",{onClick:()=>{if(eo.length<2){alert("Выберите минимум 2 стены для объединения (удерживайте Ctrl и кликайте по стенам)");return}if(!eq(eo)){alert("Выбранные стены не могут быть объединены. Убедитесь, что они соединены и параллельны.");return}let e=eo[0],t=Math.abs(e.x2-e.x1)>Math.abs(e.y2-e.y1),i=1/0,a=-1/0,o=1/0,s=-1/0;eo.forEach(e=>{i=Math.min(i,e.x1,e.x2),a=Math.max(a,e.x1,e.x2),o=Math.min(o,e.y1,e.y2),s=Math.max(s,e.y1,e.y2)});let r={id:Date.now(),x1:t?i:e.x1,y1:t?e.y1:o,x2:t?a:e.x2,y2:t?e.y2:s,length:t?(a-i)/30:(s-o)/30,thickness:e.thickness,type:e.type},n=eo.map(e=>e.id),l=D.filter(e=>!n.includes(e.id));l.push(r),T(l),es([]),k(r),ed({elements:N,walls:l})},title:"Объединить выбранные стены",className:"jsx-964e21069faa8b83 merge-btn",children:["\uD83D\uDD17 Объединить стены (",eo.length,")"]})})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-section",children:[(0,a.jsx)("h3",{className:"jsx-964e21069faa8b83",children:"Управление"}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 zoom-controls",children:[(0,a.jsx)("button",{onClick:()=>l(e=>Math.min(5,1.2*e)),className:"jsx-964e21069faa8b83",children:"\uD83D\uDD0D+"}),(0,a.jsxs)("span",{className:"jsx-964e21069faa8b83",children:[Math.round(100*n),"%"]}),(0,a.jsx)("button",{onClick:()=>l(e=>Math.max(.3,e/1.2)),className:"jsx-964e21069faa8b83",children:"\uD83D\uDD0D-"}),(0,a.jsx)("button",{onClick:()=>{l(1),c({x:0,y:0})},className:"jsx-964e21069faa8b83",children:"\uD83C\uDFAF Сброс"})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 hotkeys-info",children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 hotkey-item",children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Ctrl+Z"}),(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Отменить"})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 hotkey-item",children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Enter"}),(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Подтвердить"})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 hotkey-item",children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Delete"}),(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Удалить"})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 hotkey-item",children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Ctrl+Click"}),(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Выбор стен"})]})]})]}),w&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-section",children:[(0,a.jsx)("h3",{className:"jsx-964e21069faa8b83",children:"Размеры элемента"}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 size-controls",children:[void 0!==w.realWidth&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 size-input",children:[(0,a.jsx)("label",{className:"jsx-964e21069faa8b83",children:"Ширина (мм):"}),(0,a.jsx)("input",{type:"number",min:"100",max:"50000",step:"10",value:Math.round(1e3*(w.realWidth||0)),onChange:e=>{let t=parseFloat(e.target.value);t&&t>0&&e_("width",t/1e3)},className:"jsx-964e21069faa8b83"})]}),void 0!==w.realHeight&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 size-input",children:[(0,a.jsx)("label",{className:"jsx-964e21069faa8b83",children:"Высота (мм):"}),(0,a.jsx)("input",{type:"number",min:"100",max:"50000",step:"10",value:Math.round(1e3*(w.realHeight||0)),onChange:e=>{let t=parseFloat(e.target.value);t&&t>0&&e_("height",t/1e3)},className:"jsx-964e21069faa8b83"})]}),void 0!==w.length&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 size-input",children:[(0,a.jsx)("label",{className:"jsx-964e21069faa8b83",children:"Длина (мм):"}),(0,a.jsx)("input",{type:"number",min:"100",max:"20000",step:"10",value:Math.round(1e3*(w.length||0)),onChange:e=>{let t=parseFloat(e.target.value);t&&t>0&&eK(t/1e3)},className:"jsx-964e21069faa8b83"})]}),("door"===w.type||"window"===w.type)&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 size-input",children:[(0,a.jsx)("label",{className:"jsx-964e21069faa8b83",children:"Ширина (мм):"}),(0,a.jsx)("input",{type:"number",min:"300",max:"3000",step:"50",value:Math.round(1e3*(w.realWidth||0)),onChange:e=>{let t=parseFloat(e.target.value);t&&t>0&&eZ(t/1e3)},className:"jsx-964e21069faa8b83"})]})]})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 panel-section",children:[(0,a.jsx)("h3",{className:"jsx-964e21069faa8b83",children:"Информация о проекте"}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 project-details",children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Название:"}),(0,a.jsx)("strong",{className:"jsx-964e21069faa8b83",children:t.house.title})]}),(()=>{let e=N.find(e=>"house"===e.type);return e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Размеры дома:"}),(0,a.jsxs)("strong",{className:"jsx-964e21069faa8b83",children:[(1e3*(e.realWidth||0)).toFixed(0),"\xd7",(1e3*(e.realHeight||0)).toFixed(0),"мм"]})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Площадь:"}),(0,a.jsxs)("strong",{className:"jsx-964e21069faa8b83",children:[((e.realWidth||0)*(e.realHeight||0)).toFixed(1),"м\xb2"]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Размеры дома:"}),(0,a.jsxs)("strong",{className:"jsx-964e21069faa8b83",children:[(1e3*t.house.width).toFixed(0),"\xd7",(1e3*t.house.height).toFixed(0),"мм"]})]}),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Площадь:"}),(0,a.jsxs)("strong",{className:"jsx-964e21069faa8b83",children:[t.house.area,"м\xb2"]})]})]})})(),(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item",children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Участок:"}),(0,a.jsxs)("strong",{className:"jsx-964e21069faa8b83",children:[(1e3*t.lotSize.width).toFixed(0),"\xd7",(1e3*t.lotSize.height).toFixed(0),"мм (",(t.lotSize.width*t.lotSize.height/100).toFixed(2)," соток)"]})]}),w&&(0,a.jsxs)("div",{className:"jsx-964e21069faa8b83 detail-item selected-info",children:[(0,a.jsx)("span",{className:"jsx-964e21069faa8b83",children:"Выбран:"}),(0,a.jsx)("strong",{className:"jsx-964e21069faa8b83",children:"house"===w.type?"Дом":"Элемент"})]})]})]})]}),_&&(0,a.jsx)("div",{className:"jsx-964e21069faa8b83 collapsed-panel",children:(0,a.jsx)("button",{onClick:()=>K(!1),title:"Развернуть панель",className:"jsx-964e21069faa8b83 expand-btn",children:"◀"})})]}),(0,a.jsx)(s(),{id:"964e21069faa8b83",children:".constructor-interface.jsx-964e21069faa8b83{width:100vw;height:100vh;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;background:var(--light-gray);-webkit-animation:fadeIn.5s ease-in-out;-moz-animation:fadeIn.5s ease-in-out;-o-animation:fadeIn.5s ease-in-out;animation:fadeIn.5s ease-in-out}@-webkit-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-o-keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.constructor-header.jsx-964e21069faa8b83{background:var(--primary-dark);color:var(--white);padding:8px 16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-shadow:0 2px 8px rgba(0,0,0,.1);-moz-box-shadow:0 2px 8px rgba(0,0,0,.1);box-shadow:0 2px 8px rgba(0,0,0,.1);min-height:50px}.header-left.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:20px}.back-btn.jsx-964e21069faa8b83{background:var(--color-accent);color:var(--color-white);border:none;padding:6px 12px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;cursor:pointer;font-size:13px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.back-btn.jsx-964e21069faa8b83:hover{background:#c55a24}.constructor-header.jsx-964e21069faa8b83 h1.jsx-964e21069faa8b83{font-size:24px!important;margin:0;font-weight:500}.header-right.jsx-964e21069faa8b83 .project-info.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:12px;font-size:12px;opacity:.9}.constructor-body.jsx-964e21069faa8b83{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;overflow:hidden}.workspace.jsx-964e21069faa8b83{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;position:relative;background:#3a3b47}canvas.jsx-964e21069faa8b83{width:100%;height:100%;-ms-touch-action:-ms-none;-ms-touch-action:none;touch-action:none}.control-panel.jsx-964e21069faa8b83{width:280px;min-width:280px;max-width:280px;background:var(--primary-dark);color:var(--white);padding:12px;overflow-y:auto;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:12px;-webkit-transition:-webkit-transform.3s ease,width.3s ease;-moz-transition:-moz-transform.3s ease,width.3s ease;-o-transition:-o-transform.3s ease,width.3s ease;transition:-webkit-transform.3s ease,width.3s ease;transition:-moz-transform.3s ease,width.3s ease;transition:-o-transform.3s ease,width.3s ease;transition:transform.3s ease,width.3s ease;position:relative}.control-panel.collapsed.jsx-964e21069faa8b83{-webkit-transform:translatex(100%);-moz-transform:translatex(100%);-ms-transform:translatex(100%);-o-transform:translatex(100%);transform:translatex(100%);width:0;min-width:0;padding:0;overflow:hidden}.collapsed-panel.jsx-964e21069faa8b83{position:fixed;right:0;top:50%;-webkit-transform:translatey(-50%);-moz-transform:translatey(-50%);-ms-transform:translatey(-50%);-o-transform:translatey(-50%);transform:translatey(-50%);z-index:1000}.expand-btn.jsx-964e21069faa8b83{background:var(--primary-dark);color:var(--white);border:none;padding:20px 8px;-webkit-border-radius:8px 0 0 8px;-moz-border-radius:8px 0 0 8px;border-radius:8px 0 0 8px;cursor:pointer;font-size:20px;-webkit-box-shadow:-2px 0 8px rgba(0,0,0,.2);-moz-box-shadow:-2px 0 8px rgba(0,0,0,.2);box-shadow:-2px 0 8px rgba(0,0,0,.2);-webkit-transition:all.3s ease;-moz-transition:all.3s ease;-o-transition:all.3s ease;transition:all.3s ease}.expand-btn.jsx-964e21069faa8b83:hover{background:var(--accent-orange);padding-left:12px}.panel-header.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:8px;padding-bottom:8px;border-bottom:1px solid rgba(255,255,255,.2)}.calculate-btn.jsx-964e21069faa8b83{background:var(--color-accent);color:var(--color-white);border:none;padding:6px 10px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;cursor:pointer;font-size:11px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:4px}.calculate-btn.jsx-964e21069faa8b83:hover{background:#c55a24;-webkit-transform:translatey(-1px);-moz-transform:translatey(-1px);-ms-transform:translatey(-1px);-o-transform:translatey(-1px);transform:translatey(-1px)}.collapse-btn.jsx-964e21069faa8b83{background:transparent;color:var(--color-white);border:1px solid rgba(255,255,255,.3);padding:4px 6px;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;cursor:pointer;font-size:12px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.collapse-btn.jsx-964e21069faa8b83:hover{background:rgba(255,255,255,.1);border-color:var(--accent-orange)}.panel-section.jsx-964e21069faa8b83 h3.jsx-964e21069faa8b83{margin:0 0 8px 0;font-size:12px!important;color:var(--color-white);border-bottom:1px solid rgba(255,255,255,.2);padding-bottom:4px;font-weight:500}.view-toggle.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;background:rgba(255,255,255,.1);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;overflow:hidden}.view-toggle.jsx-964e21069faa8b83 button.jsx-964e21069faa8b83{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;padding:8px 10px;border:none;background:transparent;color:var(--color-white);cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;font-size:12px}.view-toggle.jsx-964e21069faa8b83 button.active.jsx-964e21069faa8b83{background:var(--accent-orange)}.tools-grid.jsx-964e21069faa8b83{display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px}.tool-btn.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:2px;padding:8px 4px;border:1px solid rgba(255,255,255,.2);background:transparent;color:var(--color-white);-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s}.tool-btn.jsx-964e21069faa8b83:hover{background:rgba(255,255,255,.1)}.tool-btn.active.jsx-964e21069faa8b83{background:var(--accent-orange);border-color:var(--accent-orange)}.tool-icon.jsx-964e21069faa8b83{font-size:16px}.tool-name.jsx-964e21069faa8b83{font-size:10px}.zoom-controls.jsx-964e21069faa8b83{display:grid;grid-template-columns:1fr auto 1fr 1fr;gap:4px;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.zoom-controls.jsx-964e21069faa8b83 button.jsx-964e21069faa8b83{padding:6px 8px;border:1px solid rgba(255,255,255,.2);background:transparent;color:var(--color-white);-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;cursor:pointer;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;font-size:11px}.zoom-controls.jsx-964e21069faa8b83 button.jsx-964e21069faa8b83:hover{background:rgba(255,255,255,.1)}.zoom-controls.jsx-964e21069faa8b83 span.jsx-964e21069faa8b83{text-align:center;font-size:11px}.hotkeys-info.jsx-964e21069faa8b83{margin-top:8px;padding-top:8px;border-top:1px solid rgba(255,255,255,.1)}.hotkey-item.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:2px 0;font-size:9px}.hotkey-item.jsx-964e21069faa8b83 span.jsx-964e21069faa8b83:first-child{background:rgba(255,255,255,.1);padding:1px 4px;-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;font-family:monospace;font-size:8px}.project-details.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:4px}.detail-item.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:4px 0;border-bottom:1px solid rgba(255,255,255,.1);font-size:11px}.detail-item.jsx-964e21069faa8b83 span.jsx-964e21069faa8b83{opacity:.8}.detail-item.jsx-964e21069faa8b83 strong.jsx-964e21069faa8b83{color:var(--accent-orange)}.selected-info.jsx-964e21069faa8b83{background:rgba(223,104,43,.1);padding:2px 6px;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;margin:2px 0}.size-controls.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:6px}.size-input.jsx-964e21069faa8b83{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:2px}.size-input.jsx-964e21069faa8b83 label.jsx-964e21069faa8b83{font-size:10px;opacity:.8}.size-input.jsx-964e21069faa8b83 input.jsx-964e21069faa8b83{padding:4px 6px;border:1px solid rgba(255,255,255,.2);-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;background:rgba(255,255,255,.1);color:var(--color-white);font-size:11px}.size-input.jsx-964e21069faa8b83 input.jsx-964e21069faa8b83:focus{outline:none;border-color:var(--accent-orange);background:rgba(255,255,255,.15)}.merge-section.jsx-964e21069faa8b83{margin-top:8px;padding-top:8px;border-top:1px solid rgba(255,255,255,.2)}.merge-btn.jsx-964e21069faa8b83{width:100%;padding:8px 12px;background:var(--color-accent);color:var(--color-white);border:none;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;cursor:pointer;font-size:11px;-webkit-transition:all.2s;-moz-transition:all.2s;-o-transition:all.2s;transition:all.2s;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;gap:4px}.merge-btn.jsx-964e21069faa8b83:hover{background:#c55a24;-webkit-transform:translatey(-1px);-moz-transform:translatey(-1px);-ms-transform:translatey(-1px);-o-transform:translatey(-1px);transform:translatey(-1px)}@media(max-width:768px){.constructor-header.jsx-964e21069faa8b83{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:12px;padding:12px 16px}.header-left.jsx-964e21069faa8b83{width:100%;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.header-right.jsx-964e21069faa8b83 .project-info.jsx-964e21069faa8b83{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:4px;text-align:center}.constructor-body.jsx-964e21069faa8b83{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.control-panel.jsx-964e21069faa8b83{width:100%;min-width:auto;max-width:none;height:40%;padding:16px;gap:16px;-webkit-transform:none;-moz-transform:none;-ms-transform:none;-o-transform:none;transform:none}.control-panel.collapsed.jsx-964e21069faa8b83{-webkit-transform:translatey(100%);-moz-transform:translatey(100%);-ms-transform:translatey(100%);-o-transform:translatey(100%);transform:translatey(100%);height:0;padding:0}.collapsed-panel.jsx-964e21069faa8b83{position:fixed;bottom:0;left:50%;-webkit-transform:translatex(-50%);-moz-transform:translatex(-50%);-ms-transform:translatex(-50%);-o-transform:translatex(-50%);transform:translatex(-50%);right:auto;top:auto}.expand-btn.jsx-964e21069faa8b83{-webkit-border-radius:8px 8px 0 0;-moz-border-radius:8px 8px 0 0;border-radius:8px 8px 0 0;padding:8px 20px}.panel-header.jsx-964e21069faa8b83{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:8px}.calculate-btn.jsx-964e21069faa8b83{width:100%;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.workspace.jsx-964e21069faa8b83{height:60%}.tools-grid.jsx-964e21069faa8b83{grid-template-columns:repeat(3,1fr)}.zoom-controls.jsx-964e21069faa8b83{grid-template-columns:repeat(4,1fr)}}"})]})]})}var d=function(){let[e,t]=(0,r.useState)(!0),[i,o]=(0,r.useState)(null),[n,x]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{document.body.style.margin="0",document.body.style.padding="0",document.body.style.overflow="hidden";let e=()=>{getComputedStyle(document.documentElement).getPropertyValue("--primary-dark").trim()&&"complete"===document.readyState?x(!1):setTimeout(e,50)},t=setTimeout(e,100),i=setTimeout(()=>{x(!1)},2e3);return()=>{document.body.style.margin="",document.body.style.padding="",document.body.style.overflow="",clearTimeout(t),clearTimeout(i)}},[]),n)?(0,a.jsxs)("div",{className:"jsx-bb5537eae6442a17 constructor-loading",children:[(0,a.jsxs)("div",{className:"jsx-bb5537eae6442a17 loading-content",children:[(0,a.jsx)("div",{className:"jsx-bb5537eae6442a17 spinner"}),(0,a.jsx)("p",{className:"jsx-bb5537eae6442a17",children:"Загрузка конструктора..."})]}),(0,a.jsx)(s(),{id:"bb5537eae6442a17",children:".constructor-loading.jsx-bb5537eae6442a17{position:fixed;top:0;left:0;width:100vw;height:100vh;background:var(--primary-dark);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;z-index:9999}.loading-content.jsx-bb5537eae6442a17{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:20px;color:var(--white)}.spinner.jsx-bb5537eae6442a17{width:50px;height:50px;border:4px solid rgba(255,255,255,.1);border-top:4px solid var(--accent-orange);-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;-webkit-animation:spin 1s linear infinite;-moz-animation:spin 1s linear infinite;-o-animation:spin 1s linear infinite;animation:spin 1s linear infinite}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}.loading-content.jsx-bb5537eae6442a17 p.jsx-bb5537eae6442a17{font-size:16px;margin:0;opacity:.9}"})]}):e?(0,a.jsx)(l,{onComplete:e=>{o(e),t(!1)}}):(0,a.jsx)(c,{initialData:i,onBack:()=>{t(!0)}})}}}]);